<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<title>MdePkg[all]: MdePkg/Include/Ppi/Security2.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">MdePkg[all]
   &#160;<span id="projectnumber">1.08</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('_ppi_2_security2_8h.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">Security2.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct___e_f_i___p_e_i___s_e_c_u_r_i_t_y2___p_p_i.html">_EFI_PEI_SECURITY2_PPI</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a53cdbd738e7c97c7e001adb98d26a3a7"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_ppi_2_security2_8h.html#a53cdbd738e7c97c7e001adb98d26a3a7">EFI_PEI_SECURITY2_PPI_GUID</a>&#160;&#160;&#160;{ 0xdcd0be23, 0x9586, 0x40f4, { 0xb6, 0x43, 0x6, 0x52, 0x2c, 0xed, 0x4e, 0xde } }</td></tr>
<tr class="separator:a53cdbd738e7c97c7e001adb98d26a3a7"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:a3a006d2cd413b3e82379fa30b5fea6ed"><td class="memItemLeft" align="right" valign="top">typedef struct <br class="typebreak"/>
<a class="el" href="struct___e_f_i___p_e_i___s_e_c_u_r_i_t_y2___p_p_i.html">_EFI_PEI_SECURITY2_PPI</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_ppi_2_security2_8h.html#a3a006d2cd413b3e82379fa30b5fea6ed">EFI_PEI_SECURITY2_PPI</a></td></tr>
<tr class="separator:a3a006d2cd413b3e82379fa30b5fea6ed"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a274b42725ac29d9db9eb775c5ee7a99b"><td class="memItemLeft" align="right" valign="top">typedef <a class="el" href="_uefi_base_type_8h.html#aa8fe0c70f8531326ad565427ea96c1f4">EFI_STATUS</a>(<a class="el" href="_ebc_2_processor_bind_8h.html#aa3998ed6456694d79e9a45f821f379ed">EFIAPI</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_ppi_2_security2_8h.html#a274b42725ac29d9db9eb775c5ee7a99b">EFI_PEI_SECURITY_AUTHENTICATION_STATE</a> )(<a class="el" href="_base_8h.html#ac2bbd6d630a06a980d9a92ddb9a49928">IN</a> <a class="el" href="_base_8h.html#a0c33b494a68ce28497e7ce8e5e95feff">CONST</a> <a class="el" href="_pi_pei_cis_8h.html#a0e7bc722610916e07cd0819a921643dc">EFI_PEI_SERVICES</a> **PeiServices, <a class="el" href="_base_8h.html#ac2bbd6d630a06a980d9a92ddb9a49928">IN</a> <a class="el" href="_base_8h.html#a0c33b494a68ce28497e7ce8e5e95feff">CONST</a> <a class="el" href="_ppi_2_security2_8h.html#a3a006d2cd413b3e82379fa30b5fea6ed">EFI_PEI_SECURITY2_PPI</a> *<a class="el" href="_ppi_2_mm_control_8h.html#a9b72b028448e2d973a9f4fa637b71951">This</a>, <a class="el" href="_base_8h.html#ac2bbd6d630a06a980d9a92ddb9a49928">IN</a> <a class="el" href="_ia32_2_processor_bind_8h.html#aa3f529997f999e2b7a3db6a453c0999b">UINT32</a> AuthenticationStatus, <a class="el" href="_base_8h.html#ac2bbd6d630a06a980d9a92ddb9a49928">IN</a> <a class="el" href="_pi_pei_cis_8h.html#aa91cb3539cfb2742ee94c7bd0ab1e702">EFI_PEI_FV_HANDLE</a> FvHandle, <a class="el" href="_base_8h.html#ac2bbd6d630a06a980d9a92ddb9a49928">IN</a> <a class="el" href="_pi_pei_cis_8h.html#a98129642fe8f4e1c925ae7d76995fd56">EFI_PEI_FILE_HANDLE</a> <a class="el" href="_shell_8h.html#a6de3cd218b005daa6936575032920396">FileHandle</a>, <a class="el" href="_base_8h.html#ac2bbd6d630a06a980d9a92ddb9a49928">IN</a> <a class="el" href="_base_8h.html#aec78e7a9e90a406a56f859ee456e8eae">OUT</a> <a class="el" href="_ia32_2_processor_bind_8h.html#a241cb7969626e26a0961a75645528770">BOOLEAN</a> *DeferExecution)</td></tr>
<tr class="separator:a274b42725ac29d9db9eb775c5ee7a99b"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:ab9da91ab2a7eb38144371fca71199475"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_uefi_base_type_8h.html#ad87614428813f71edb2c2d802e9ce2af">EFI_GUID</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_ppi_2_security2_8h.html#ab9da91ab2a7eb38144371fca71199475">gEfiPeiSecurity2PpiGuid</a></td></tr>
<tr class="separator:ab9da91ab2a7eb38144371fca71199475"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>This file declares Pei Security2 PPI.</p>
<p>This PPI is installed by some platform PEIM that abstracts the security policy to the PEI Foundation, namely the case of a PEIM's authentication state being returned during the PEI section extraction process.</p>
<p>Copyright (c) 2006 - 2018, Intel Corporation. All rights reserved.<br/>
 SPDX-License-Identifier: BSD-2-Clause-Patent</p>
<dl class="section user"><dt>Revision Reference:</dt><dd>This PPI is introduced in PI Version 1.0. </dd></dl>
</div><h2 class="groupheader">Macro Definition Documentation</h2>
<a class="anchor" id="a53cdbd738e7c97c7e001adb98d26a3a7"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define EFI_PEI_SECURITY2_PPI_GUID&#160;&#160;&#160;{ 0xdcd0be23, 0x9586, 0x40f4, { 0xb6, 0x43, 0x6, 0x52, 0x2c, 0xed, 0x4e, 0xde } }</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<h2 class="groupheader">Typedef Documentation</h2>
<a class="anchor" id="a3a006d2cd413b3e82379fa30b5fea6ed"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="struct___e_f_i___p_e_i___s_e_c_u_r_i_t_y2___p_p_i.html">_EFI_PEI_SECURITY2_PPI</a> <a class="el" href="_ppi_2_security2_8h.html#a3a006d2cd413b3e82379fa30b5fea6ed">EFI_PEI_SECURITY2_PPI</a></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a274b42725ac29d9db9eb775c5ee7a99b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef <a class="el" href="_uefi_base_type_8h.html#aa8fe0c70f8531326ad565427ea96c1f4">EFI_STATUS</a>(<a class="el" href="_ebc_2_processor_bind_8h.html#aa3998ed6456694d79e9a45f821f379ed">EFIAPI</a> * EFI_PEI_SECURITY_AUTHENTICATION_STATE)(<a class="el" href="_base_8h.html#ac2bbd6d630a06a980d9a92ddb9a49928">IN</a> <a class="el" href="_base_8h.html#a0c33b494a68ce28497e7ce8e5e95feff">CONST</a> <a class="el" href="_pi_pei_cis_8h.html#a0e7bc722610916e07cd0819a921643dc">EFI_PEI_SERVICES</a> **PeiServices, <a class="el" href="_base_8h.html#ac2bbd6d630a06a980d9a92ddb9a49928">IN</a> <a class="el" href="_base_8h.html#a0c33b494a68ce28497e7ce8e5e95feff">CONST</a> <a class="el" href="_ppi_2_security2_8h.html#a3a006d2cd413b3e82379fa30b5fea6ed">EFI_PEI_SECURITY2_PPI</a> *<a class="el" href="_ppi_2_mm_control_8h.html#a9b72b028448e2d973a9f4fa637b71951">This</a>, <a class="el" href="_base_8h.html#ac2bbd6d630a06a980d9a92ddb9a49928">IN</a> <a class="el" href="_ia32_2_processor_bind_8h.html#aa3f529997f999e2b7a3db6a453c0999b">UINT32</a> AuthenticationStatus, <a class="el" href="_base_8h.html#ac2bbd6d630a06a980d9a92ddb9a49928">IN</a> <a class="el" href="_pi_pei_cis_8h.html#aa91cb3539cfb2742ee94c7bd0ab1e702">EFI_PEI_FV_HANDLE</a> FvHandle, <a class="el" href="_base_8h.html#ac2bbd6d630a06a980d9a92ddb9a49928">IN</a> <a class="el" href="_pi_pei_cis_8h.html#a98129642fe8f4e1c925ae7d76995fd56">EFI_PEI_FILE_HANDLE</a> <a class="el" href="_shell_8h.html#a6de3cd218b005daa6936575032920396">FileHandle</a>, <a class="el" href="_base_8h.html#ac2bbd6d630a06a980d9a92ddb9a49928">IN</a> <a class="el" href="_base_8h.html#aec78e7a9e90a406a56f859ee456e8eae">OUT</a> <a class="el" href="_ia32_2_processor_bind_8h.html#a241cb7969626e26a0961a75645528770">BOOLEAN</a> *DeferExecution)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Allows the platform builder to implement a security policy in response to varying file authentication states.</p>
<p>This service is published by some platform PEIM. The purpose of this service is to expose a given platform's policy-based response to the PEI Foundation. For example, if there is a PEIM in a GUIDed encapsulation section and the extraction of the PEI file section yields an authentication failure, there is no a priori policy in the PEI Foundation. Specifically, this situation leads to the question whether PEIMs that are either not in GUIDed sections or are in sections whose authentication fails should still be executed.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">PeiServices</td><td>An indirect pointer to the PEI Services Table published by the PEI Foundation. </td></tr>
    <tr><td class="paramname">This</td><td>Interface pointer that implements the particular EFI_PEI_SECURITY2_PPI instance. </td></tr>
    <tr><td class="paramname">AuthenticationStatus</td><td>Authentication status of the file. xx00 Image was not signed. xxx1 Platform security policy override. Assumes same meaning as 0010 (the image was signed, the signature was tested, and the signature passed authentication test). 0010 Image was signed, the signature was tested, and the signature passed authentication test. 0110 Image was signed and the signature was not tested. 1010 Image was signed, the signature was tested, and the signature failed the authentication test. </td></tr>
    <tr><td class="paramname">FvHandle</td><td>Handle of the volume in which the file resides. This allows different policies depending on different firmware volumes. </td></tr>
    <tr><td class="paramname">FileHandle</td><td>Handle of the file under review. </td></tr>
    <tr><td class="paramname">DeferExecution</td><td>Pointer to a variable that alerts the PEI Foundation to defer execution of a PEIM.</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">EFI_SUCCESS</td><td>The service performed its action successfully. </td></tr>
    <tr><td class="paramname">EFI_SECURITY_VIOLATION</td><td>The object cannot be trusted. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a class="anchor" id="ab9da91ab2a7eb38144371fca71199475"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_uefi_base_type_8h.html#ad87614428813f71edb2c2d802e9ce2af">EFI_GUID</a> gEfiPeiSecurity2PpiGuid</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_ee16cea0340e4558b8b17c3b12ae3d0b.html">MdePkg</a></li><li class="navelem"><a class="el" href="dir_43dbc6def9233b1fec759bd8d9ab8e67.html">Include</a></li><li class="navelem"><a class="el" href="dir_51f2417dcd5a0e61f471615fd8fdb9b8.html">Ppi</a></li><li class="navelem"><a class="el" href="_ppi_2_security2_8h.html">Security2.h</a></li>
    <li class="footer">Generated on Sun Dec 5 2021 03:51:06 for MdePkg[all] by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.6 </li>
  </ul>
</div>
</body>
</html>
