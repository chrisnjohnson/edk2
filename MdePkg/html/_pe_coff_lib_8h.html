<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<title>MdePkg[all]: MdePkg/Include/Library/PeCoffLib.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">MdePkg[all]
   &#160;<span id="projectnumber">1.08</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('_pe_coff_lib_8h.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">PeCoffLib.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_p_e___c_o_f_f___l_o_a_d_e_r___i_m_a_g_e___c_o_n_t_e_x_t.html">PE_COFF_LOADER_IMAGE_CONTEXT</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a4174e6f1be8a3a37874d38146eee96a2"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_pe_coff_lib_8h.html#a4174e6f1be8a3a37874d38146eee96a2">IMAGE_ERROR_SUCCESS</a>&#160;&#160;&#160;0</td></tr>
<tr class="separator:a4174e6f1be8a3a37874d38146eee96a2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab0a0b530c020f17d32e189e950d367c1"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_pe_coff_lib_8h.html#ab0a0b530c020f17d32e189e950d367c1">IMAGE_ERROR_IMAGE_READ</a>&#160;&#160;&#160;1</td></tr>
<tr class="separator:ab0a0b530c020f17d32e189e950d367c1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afcb9a16380c82e7207b55f2267b6b01b"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_pe_coff_lib_8h.html#afcb9a16380c82e7207b55f2267b6b01b">IMAGE_ERROR_INVALID_PE_HEADER_SIGNATURE</a>&#160;&#160;&#160;2</td></tr>
<tr class="separator:afcb9a16380c82e7207b55f2267b6b01b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a64fb7c351d064acc0f068e77cc6deb87"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_pe_coff_lib_8h.html#a64fb7c351d064acc0f068e77cc6deb87">IMAGE_ERROR_INVALID_MACHINE_TYPE</a>&#160;&#160;&#160;3</td></tr>
<tr class="separator:a64fb7c351d064acc0f068e77cc6deb87"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a40704ffd2cea8c3b33f91c64d528bb56"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_pe_coff_lib_8h.html#a40704ffd2cea8c3b33f91c64d528bb56">IMAGE_ERROR_INVALID_SUBSYSTEM</a>&#160;&#160;&#160;4</td></tr>
<tr class="separator:a40704ffd2cea8c3b33f91c64d528bb56"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a581ecf5efddbfa2284456062240a8292"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_pe_coff_lib_8h.html#a581ecf5efddbfa2284456062240a8292">IMAGE_ERROR_INVALID_IMAGE_ADDRESS</a>&#160;&#160;&#160;5</td></tr>
<tr class="separator:a581ecf5efddbfa2284456062240a8292"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad196df062aca79941bbb9c018baf10a5"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_pe_coff_lib_8h.html#ad196df062aca79941bbb9c018baf10a5">IMAGE_ERROR_INVALID_IMAGE_SIZE</a>&#160;&#160;&#160;6</td></tr>
<tr class="separator:ad196df062aca79941bbb9c018baf10a5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8b2ce78beada49c4dc3ea3102b42dbb6"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_pe_coff_lib_8h.html#a8b2ce78beada49c4dc3ea3102b42dbb6">IMAGE_ERROR_INVALID_SECTION_ALIGNMENT</a>&#160;&#160;&#160;7</td></tr>
<tr class="separator:a8b2ce78beada49c4dc3ea3102b42dbb6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1d7a363e7b74611de9ddc633df5909af"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_pe_coff_lib_8h.html#a1d7a363e7b74611de9ddc633df5909af">IMAGE_ERROR_SECTION_NOT_LOADED</a>&#160;&#160;&#160;8</td></tr>
<tr class="separator:a1d7a363e7b74611de9ddc633df5909af"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a567f2d294f7595d9307d8e5a9cfcbc3b"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_pe_coff_lib_8h.html#a567f2d294f7595d9307d8e5a9cfcbc3b">IMAGE_ERROR_FAILED_RELOCATION</a>&#160;&#160;&#160;9</td></tr>
<tr class="separator:a567f2d294f7595d9307d8e5a9cfcbc3b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a44180fa654565ed888a7e72987b10579"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_pe_coff_lib_8h.html#a44180fa654565ed888a7e72987b10579">IMAGE_ERROR_FAILED_ICACHE_FLUSH</a>&#160;&#160;&#160;10</td></tr>
<tr class="separator:a44180fa654565ed888a7e72987b10579"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a27fdaebc43ea56f473842eac9c53cde8"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_pe_coff_lib_8h.html#a27fdaebc43ea56f473842eac9c53cde8">IMAGE_ERROR_UNSUPPORTED</a>&#160;&#160;&#160;11</td></tr>
<tr class="separator:a27fdaebc43ea56f473842eac9c53cde8"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:a5e79e54d0a98d4ca1edd0dd3b9427443"><td class="memItemLeft" align="right" valign="top">typedef <a class="el" href="_base_8h.html#ae30979abefc3ca8dc6f2135dc9cc40be">RETURN_STATUS</a>(<a class="el" href="_ebc_2_processor_bind_8h.html#aa3998ed6456694d79e9a45f821f379ed">EFIAPI</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_pe_coff_lib_8h.html#a5e79e54d0a98d4ca1edd0dd3b9427443">PE_COFF_LOADER_READ_FILE</a> )(<a class="el" href="_base_8h.html#ac2bbd6d630a06a980d9a92ddb9a49928">IN</a> <a class="el" href="_shell_8h.html#aa8ff5bd3c2d6cb377b1dd3bbe3e0cfa8">VOID</a> *<a class="el" href="_shell_8h.html#a6de3cd218b005daa6936575032920396">FileHandle</a>, <a class="el" href="_base_8h.html#ac2bbd6d630a06a980d9a92ddb9a49928">IN</a> <a class="el" href="_ia32_2_processor_bind_8h.html#ac0b1ca9b01db611e0f7f2080a2699135">UINTN</a> FileOffset, <a class="el" href="_base_8h.html#ac2bbd6d630a06a980d9a92ddb9a49928">IN</a> <a class="el" href="_base_8h.html#aec78e7a9e90a406a56f859ee456e8eae">OUT</a> <a class="el" href="_ia32_2_processor_bind_8h.html#ac0b1ca9b01db611e0f7f2080a2699135">UINTN</a> *<a class="el" href="_shell_8h.html#a4984ffaa9d3819980daaa90f3eefe7b5">ReadSize</a>, <a class="el" href="_base_8h.html#aec78e7a9e90a406a56f859ee456e8eae">OUT</a> <a class="el" href="_shell_8h.html#aa8ff5bd3c2d6cb377b1dd3bbe3e0cfa8">VOID</a> *<a class="el" href="_supplicant_8h.html#ac67e1217dfc7830023855fe9cade358e">Buffer</a>)</td></tr>
<tr class="separator:a5e79e54d0a98d4ca1edd0dd3b9427443"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ab5c5bcd17794b6de4bb93a8eb2129b94"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_base_8h.html#ae30979abefc3ca8dc6f2135dc9cc40be">RETURN_STATUS</a> <a class="el" href="_ebc_2_processor_bind_8h.html#aa3998ed6456694d79e9a45f821f379ed">EFIAPI</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_pe_coff_lib_8h.html#ab5c5bcd17794b6de4bb93a8eb2129b94">PeCoffLoaderGetImageInfo</a> (<a class="el" href="_base_8h.html#ac2bbd6d630a06a980d9a92ddb9a49928">IN</a> <a class="el" href="_base_8h.html#aec78e7a9e90a406a56f859ee456e8eae">OUT</a> <a class="el" href="struct_p_e___c_o_f_f___l_o_a_d_e_r___i_m_a_g_e___c_o_n_t_e_x_t.html">PE_COFF_LOADER_IMAGE_CONTEXT</a> *ImageContext)</td></tr>
<tr class="separator:ab5c5bcd17794b6de4bb93a8eb2129b94"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2a50888c6100c2d1374d71668a59303f"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_base_8h.html#ae30979abefc3ca8dc6f2135dc9cc40be">RETURN_STATUS</a> <a class="el" href="_ebc_2_processor_bind_8h.html#aa3998ed6456694d79e9a45f821f379ed">EFIAPI</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_pe_coff_lib_8h.html#a2a50888c6100c2d1374d71668a59303f">PeCoffLoaderRelocateImage</a> (<a class="el" href="_base_8h.html#ac2bbd6d630a06a980d9a92ddb9a49928">IN</a> <a class="el" href="_base_8h.html#aec78e7a9e90a406a56f859ee456e8eae">OUT</a> <a class="el" href="struct_p_e___c_o_f_f___l_o_a_d_e_r___i_m_a_g_e___c_o_n_t_e_x_t.html">PE_COFF_LOADER_IMAGE_CONTEXT</a> *ImageContext)</td></tr>
<tr class="separator:a2a50888c6100c2d1374d71668a59303f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2003fb97c41baf50162901cbe9e0f988"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_base_8h.html#ae30979abefc3ca8dc6f2135dc9cc40be">RETURN_STATUS</a> <a class="el" href="_ebc_2_processor_bind_8h.html#aa3998ed6456694d79e9a45f821f379ed">EFIAPI</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_pe_coff_lib_8h.html#a2003fb97c41baf50162901cbe9e0f988">PeCoffLoaderLoadImage</a> (<a class="el" href="_base_8h.html#ac2bbd6d630a06a980d9a92ddb9a49928">IN</a> <a class="el" href="_base_8h.html#aec78e7a9e90a406a56f859ee456e8eae">OUT</a> <a class="el" href="struct_p_e___c_o_f_f___l_o_a_d_e_r___i_m_a_g_e___c_o_n_t_e_x_t.html">PE_COFF_LOADER_IMAGE_CONTEXT</a> *ImageContext)</td></tr>
<tr class="separator:a2003fb97c41baf50162901cbe9e0f988"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae95875d898be0efbc1fbaf43b9d44c6f"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_base_8h.html#ae30979abefc3ca8dc6f2135dc9cc40be">RETURN_STATUS</a> <a class="el" href="_ebc_2_processor_bind_8h.html#aa3998ed6456694d79e9a45f821f379ed">EFIAPI</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_pe_coff_lib_8h.html#ae95875d898be0efbc1fbaf43b9d44c6f">PeCoffLoaderImageReadFromMemory</a> (<a class="el" href="_base_8h.html#ac2bbd6d630a06a980d9a92ddb9a49928">IN</a> <a class="el" href="_shell_8h.html#aa8ff5bd3c2d6cb377b1dd3bbe3e0cfa8">VOID</a> *<a class="el" href="_shell_8h.html#a6de3cd218b005daa6936575032920396">FileHandle</a>, <a class="el" href="_base_8h.html#ac2bbd6d630a06a980d9a92ddb9a49928">IN</a> <a class="el" href="_ia32_2_processor_bind_8h.html#ac0b1ca9b01db611e0f7f2080a2699135">UINTN</a> FileOffset, <a class="el" href="_base_8h.html#ac2bbd6d630a06a980d9a92ddb9a49928">IN</a> <a class="el" href="_base_8h.html#aec78e7a9e90a406a56f859ee456e8eae">OUT</a> <a class="el" href="_ia32_2_processor_bind_8h.html#ac0b1ca9b01db611e0f7f2080a2699135">UINTN</a> *<a class="el" href="_shell_8h.html#a4984ffaa9d3819980daaa90f3eefe7b5">ReadSize</a>, <a class="el" href="_base_8h.html#aec78e7a9e90a406a56f859ee456e8eae">OUT</a> <a class="el" href="_shell_8h.html#aa8ff5bd3c2d6cb377b1dd3bbe3e0cfa8">VOID</a> *<a class="el" href="_supplicant_8h.html#ac67e1217dfc7830023855fe9cade358e">Buffer</a>)</td></tr>
<tr class="separator:ae95875d898be0efbc1fbaf43b9d44c6f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4827dd41b90b7887445e3c94edbdba84"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_shell_8h.html#aa8ff5bd3c2d6cb377b1dd3bbe3e0cfa8">VOID</a> <a class="el" href="_ebc_2_processor_bind_8h.html#aa3998ed6456694d79e9a45f821f379ed">EFIAPI</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_pe_coff_lib_8h.html#a4827dd41b90b7887445e3c94edbdba84">PeCoffLoaderRelocateImageForRuntime</a> (<a class="el" href="_base_8h.html#ac2bbd6d630a06a980d9a92ddb9a49928">IN</a> <a class="el" href="_base_8h.html#a8557e721a169e9f286709e9b55a64559">PHYSICAL_ADDRESS</a> ImageBase, <a class="el" href="_base_8h.html#ac2bbd6d630a06a980d9a92ddb9a49928">IN</a> <a class="el" href="_base_8h.html#a8557e721a169e9f286709e9b55a64559">PHYSICAL_ADDRESS</a> VirtImageBase, <a class="el" href="_base_8h.html#ac2bbd6d630a06a980d9a92ddb9a49928">IN</a> <a class="el" href="_ia32_2_processor_bind_8h.html#ac0b1ca9b01db611e0f7f2080a2699135">UINTN</a> ImageSize, <a class="el" href="_base_8h.html#ac2bbd6d630a06a980d9a92ddb9a49928">IN</a> <a class="el" href="_shell_8h.html#aa8ff5bd3c2d6cb377b1dd3bbe3e0cfa8">VOID</a> *RelocationData)</td></tr>
<tr class="separator:a4827dd41b90b7887445e3c94edbdba84"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5e7f95ca7feb12a3aa470b69584c2e75"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_base_8h.html#ae30979abefc3ca8dc6f2135dc9cc40be">RETURN_STATUS</a> <a class="el" href="_ebc_2_processor_bind_8h.html#aa3998ed6456694d79e9a45f821f379ed">EFIAPI</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_pe_coff_lib_8h.html#a5e7f95ca7feb12a3aa470b69584c2e75">PeCoffLoaderUnloadImage</a> (<a class="el" href="_base_8h.html#ac2bbd6d630a06a980d9a92ddb9a49928">IN</a> <a class="el" href="_base_8h.html#aec78e7a9e90a406a56f859ee456e8eae">OUT</a> <a class="el" href="struct_p_e___c_o_f_f___l_o_a_d_e_r___i_m_a_g_e___c_o_n_t_e_x_t.html">PE_COFF_LOADER_IMAGE_CONTEXT</a> *ImageContext)</td></tr>
<tr class="separator:a5e7f95ca7feb12a3aa470b69584c2e75"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Provides services to load and relocate a PE/COFF image.</p>
<p>The PE/COFF Loader Library abstracts the implementation of a PE/COFF loader for IA-32, x86, IPF, and EBC processor types. The library functions are memory-based and can be ported easily to any environment.</p>
<p>Copyright (c) 2006 - 2018, Intel Corporation. All rights reserved.<br/>
 SPDX-License-Identifier: BSD-2-Clause-Patent </p>
</div><h2 class="groupheader">Macro Definition Documentation</h2>
<a class="anchor" id="a44180fa654565ed888a7e72987b10579"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define IMAGE_ERROR_FAILED_ICACHE_FLUSH&#160;&#160;&#160;10</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a567f2d294f7595d9307d8e5a9cfcbc3b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define IMAGE_ERROR_FAILED_RELOCATION&#160;&#160;&#160;9</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="ab0a0b530c020f17d32e189e950d367c1"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define IMAGE_ERROR_IMAGE_READ&#160;&#160;&#160;1</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a581ecf5efddbfa2284456062240a8292"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define IMAGE_ERROR_INVALID_IMAGE_ADDRESS&#160;&#160;&#160;5</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="ad196df062aca79941bbb9c018baf10a5"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define IMAGE_ERROR_INVALID_IMAGE_SIZE&#160;&#160;&#160;6</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a64fb7c351d064acc0f068e77cc6deb87"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define IMAGE_ERROR_INVALID_MACHINE_TYPE&#160;&#160;&#160;3</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="afcb9a16380c82e7207b55f2267b6b01b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define IMAGE_ERROR_INVALID_PE_HEADER_SIGNATURE&#160;&#160;&#160;2</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a8b2ce78beada49c4dc3ea3102b42dbb6"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define IMAGE_ERROR_INVALID_SECTION_ALIGNMENT&#160;&#160;&#160;7</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a40704ffd2cea8c3b33f91c64d528bb56"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define IMAGE_ERROR_INVALID_SUBSYSTEM&#160;&#160;&#160;4</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a1d7a363e7b74611de9ddc633df5909af"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define IMAGE_ERROR_SECTION_NOT_LOADED&#160;&#160;&#160;8</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a4174e6f1be8a3a37874d38146eee96a2"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define IMAGE_ERROR_SUCCESS&#160;&#160;&#160;0</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a27fdaebc43ea56f473842eac9c53cde8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define IMAGE_ERROR_UNSUPPORTED&#160;&#160;&#160;11</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<h2 class="groupheader">Typedef Documentation</h2>
<a class="anchor" id="a5e79e54d0a98d4ca1edd0dd3b9427443"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef <a class="el" href="_base_8h.html#ae30979abefc3ca8dc6f2135dc9cc40be">RETURN_STATUS</a>(<a class="el" href="_ebc_2_processor_bind_8h.html#aa3998ed6456694d79e9a45f821f379ed">EFIAPI</a> * PE_COFF_LOADER_READ_FILE)(<a class="el" href="_base_8h.html#ac2bbd6d630a06a980d9a92ddb9a49928">IN</a> <a class="el" href="_shell_8h.html#aa8ff5bd3c2d6cb377b1dd3bbe3e0cfa8">VOID</a> *<a class="el" href="_shell_8h.html#a6de3cd218b005daa6936575032920396">FileHandle</a>, <a class="el" href="_base_8h.html#ac2bbd6d630a06a980d9a92ddb9a49928">IN</a> <a class="el" href="_ia32_2_processor_bind_8h.html#ac0b1ca9b01db611e0f7f2080a2699135">UINTN</a> FileOffset, <a class="el" href="_base_8h.html#ac2bbd6d630a06a980d9a92ddb9a49928">IN</a> <a class="el" href="_base_8h.html#aec78e7a9e90a406a56f859ee456e8eae">OUT</a> <a class="el" href="_ia32_2_processor_bind_8h.html#ac0b1ca9b01db611e0f7f2080a2699135">UINTN</a> *<a class="el" href="_shell_8h.html#a4984ffaa9d3819980daaa90f3eefe7b5">ReadSize</a>, <a class="el" href="_base_8h.html#aec78e7a9e90a406a56f859ee456e8eae">OUT</a> <a class="el" href="_shell_8h.html#aa8ff5bd3c2d6cb377b1dd3bbe3e0cfa8">VOID</a> *<a class="el" href="_supplicant_8h.html#ac67e1217dfc7830023855fe9cade358e">Buffer</a>)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Reads contents of a PE/COFF image.</p>
<p>A function of this type reads contents of the PE/COFF image specified by FileHandle. The read operation copies ReadSize bytes from the PE/COFF image starting at byte offset FileOffset into the buffer specified by Buffer. The size of the buffer actually read is returned in ReadSize. If FileOffset specifies an offset past the end of the PE/COFF image, a ReadSize of 0 is returned. A function of this type must be registered in the ImageRead field of a <a class="el" href="struct_p_e___c_o_f_f___l_o_a_d_e_r___i_m_a_g_e___c_o_n_t_e_x_t.html">PE_COFF_LOADER_IMAGE_CONTEXT</a> structure for the PE/COFF Loader Library service to function correctly. This function abstracts access to a PE/COFF image so it can be implemented in an environment specific manner. For example, SEC and PEI environments may access memory directly to read the contents of a PE/COFF image, and DXE or UEFI environments may require protocol services to read the contents of PE/COFF image stored on FLASH, disk, or network devices.</p>
<p>If FileHandle is not a valid handle, then <a class="el" href="_debug_lib_8h.html#a76b4aae2259415ea4b7e2c9b34ede0bb">ASSERT()</a>. If ReadSize is NULL, then <a class="el" href="_debug_lib_8h.html#a76b4aae2259415ea4b7e2c9b34ede0bb">ASSERT()</a>. If Buffer is NULL, then <a class="el" href="_debug_lib_8h.html#a76b4aae2259415ea4b7e2c9b34ede0bb">ASSERT()</a>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">FileHandle</td><td>Pointer to the file handle to read the PE/COFF image. </td></tr>
    <tr><td class="paramname">FileOffset</td><td>Offset into the PE/COFF image to begin the read operation. </td></tr>
    <tr><td class="paramname">ReadSize</td><td>On input, the size in bytes of the requested read operation. On output, the number of bytes actually read. </td></tr>
    <tr><td class="paramname">Buffer</td><td>Output buffer that contains the data read from the PE/COFF image.</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">RETURN_SUCCESS</td><td>The specified portion of the PE/COFF image was read and the size return in ReadSize. </td></tr>
    <tr><td class="paramname">RETURN_DEVICE_ERROR</td><td>The specified portion of the PE/COFF image could not be read due to a device error. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="ab5c5bcd17794b6de4bb93a8eb2129b94"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_base_8h.html#ae30979abefc3ca8dc6f2135dc9cc40be">RETURN_STATUS</a> <a class="el" href="_ebc_2_processor_bind_8h.html#aa3998ed6456694d79e9a45f821f379ed">EFIAPI</a> PeCoffLoaderGetImageInfo </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="_base_8h.html#ac2bbd6d630a06a980d9a92ddb9a49928">IN</a> <a class="el" href="_base_8h.html#aec78e7a9e90a406a56f859ee456e8eae">OUT</a> <a class="el" href="struct_p_e___c_o_f_f___l_o_a_d_e_r___i_m_a_g_e___c_o_n_t_e_x_t.html">PE_COFF_LOADER_IMAGE_CONTEXT</a> *&#160;</td>
          <td class="paramname"><em>ImageContext</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Retrieves information about a PE/COFF image.</p>
<p>Computes the PeCoffHeaderOffset, IsTeImage, ImageType, ImageAddress, ImageSize, DestinationAddress, RelocationsStripped, SectionAlignment, SizeOfHeaders, and DebugDirectoryEntryRva fields of the ImageContext structure. If ImageContext is NULL, then return RETURN_INVALID_PARAMETER. If the PE/COFF image accessed through the ImageRead service in the ImageContext structure is not a supported PE/COFF image type, then return RETURN_UNSUPPORTED. If any errors occur while computing the fields of ImageContext, then the error status is returned in the ImageError field of ImageContext. If the image is a TE image, then SectionAlignment is set to 0. The ImageRead and Handle fields of ImageContext structure must be valid prior to invoking this service.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ImageContext</td><td>The pointer to the image context structure that describes the PE/COFF image that needs to be examined by this function.</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">RETURN_SUCCESS</td><td>The information on the PE/COFF image was collected. </td></tr>
    <tr><td class="paramname">RETURN_INVALID_PARAMETER</td><td>ImageContext is NULL. </td></tr>
    <tr><td class="paramname">RETURN_UNSUPPORTED</td><td>The PE/COFF image is not supported. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="ae95875d898be0efbc1fbaf43b9d44c6f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_base_8h.html#ae30979abefc3ca8dc6f2135dc9cc40be">RETURN_STATUS</a> <a class="el" href="_ebc_2_processor_bind_8h.html#aa3998ed6456694d79e9a45f821f379ed">EFIAPI</a> PeCoffLoaderImageReadFromMemory </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="_base_8h.html#ac2bbd6d630a06a980d9a92ddb9a49928">IN</a> <a class="el" href="_shell_8h.html#aa8ff5bd3c2d6cb377b1dd3bbe3e0cfa8">VOID</a> *&#160;</td>
          <td class="paramname"><em>FileHandle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="_base_8h.html#ac2bbd6d630a06a980d9a92ddb9a49928">IN</a> <a class="el" href="_ia32_2_processor_bind_8h.html#ac0b1ca9b01db611e0f7f2080a2699135">UINTN</a>&#160;</td>
          <td class="paramname"><em>FileOffset</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="_base_8h.html#ac2bbd6d630a06a980d9a92ddb9a49928">IN</a> <a class="el" href="_base_8h.html#aec78e7a9e90a406a56f859ee456e8eae">OUT</a> <a class="el" href="_ia32_2_processor_bind_8h.html#ac0b1ca9b01db611e0f7f2080a2699135">UINTN</a> *&#160;</td>
          <td class="paramname"><em>ReadSize</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="_base_8h.html#aec78e7a9e90a406a56f859ee456e8eae">OUT</a> <a class="el" href="_shell_8h.html#aa8ff5bd3c2d6cb377b1dd3bbe3e0cfa8">VOID</a> *&#160;</td>
          <td class="paramname"><em>Buffer</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Reads contents of a PE/COFF image from a buffer in system memory.</p>
<p>This is the default implementation of a PE_COFF_LOADER_READ_FILE function that assumes FileHandle pointer to the beginning of a PE/COFF image. This function reads contents of the PE/COFF image that starts at the system memory address specified by FileHandle. The read operation copies ReadSize bytes from the PE/COFF image starting at byte offset FileOffset into the buffer specified by Buffer. The size of the buffer actually read is returned in ReadSize.</p>
<p>If FileHandle is NULL, then <a class="el" href="_debug_lib_8h.html#a76b4aae2259415ea4b7e2c9b34ede0bb">ASSERT()</a>. If ReadSize is NULL, then <a class="el" href="_debug_lib_8h.html#a76b4aae2259415ea4b7e2c9b34ede0bb">ASSERT()</a>. If Buffer is NULL, then <a class="el" href="_debug_lib_8h.html#a76b4aae2259415ea4b7e2c9b34ede0bb">ASSERT()</a>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">FileHandle</td><td>The pointer to base of the input stream </td></tr>
    <tr><td class="paramname">FileOffset</td><td>Offset into the PE/COFF image to begin the read operation. </td></tr>
    <tr><td class="paramname">ReadSize</td><td>On input, the size in bytes of the requested read operation. On output, the number of bytes actually read. </td></tr>
    <tr><td class="paramname">Buffer</td><td>Output buffer that contains the data read from the PE/COFF image.</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">RETURN_SUCCESS</td><td>The data is read from FileOffset from the Handle into the buffer. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a2003fb97c41baf50162901cbe9e0f988"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_base_8h.html#ae30979abefc3ca8dc6f2135dc9cc40be">RETURN_STATUS</a> <a class="el" href="_ebc_2_processor_bind_8h.html#aa3998ed6456694d79e9a45f821f379ed">EFIAPI</a> PeCoffLoaderLoadImage </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="_base_8h.html#ac2bbd6d630a06a980d9a92ddb9a49928">IN</a> <a class="el" href="_base_8h.html#aec78e7a9e90a406a56f859ee456e8eae">OUT</a> <a class="el" href="struct_p_e___c_o_f_f___l_o_a_d_e_r___i_m_a_g_e___c_o_n_t_e_x_t.html">PE_COFF_LOADER_IMAGE_CONTEXT</a> *&#160;</td>
          <td class="paramname"><em>ImageContext</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Loads a PE/COFF image into memory.</p>
<p>Loads the PE/COFF image accessed through the ImageRead service of ImageContext into the buffer specified by the ImageAddress and ImageSize fields of ImageContext. The caller must allocate the load buffer and fill in the ImageAddress and ImageSize fields prior to calling this function. The EntryPoint, FixupDataSize, CodeView, PdbPointer and HiiResourceData fields of ImageContext are computed. The ImageRead, Handle, PeCoffHeaderOffset, IsTeImage, Machine, ImageType, ImageAddress, ImageSize, DestinationAddress, RelocationsStripped, SectionAlignment, SizeOfHeaders, and DebugDirectoryEntryRva fields of the ImageContext structure must be valid prior to invoking this service.</p>
<p>If ImageContext is NULL, then <a class="el" href="_debug_lib_8h.html#a76b4aae2259415ea4b7e2c9b34ede0bb">ASSERT()</a>.</p>
<p>Note that if the platform does not maintain coherency between the instruction cache(s) and the data cache(s) in hardware, then the caller is responsible for performing cache maintenance operations prior to transferring control to a PE/COFF image that is loaded using this library.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ImageContext</td><td>The pointer to the image context structure that describes the PE/COFF image that is being loaded.</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">RETURN_SUCCESS</td><td>The PE/COFF image was loaded into the buffer specified by the ImageAddress and ImageSize fields of ImageContext. Extended status information is in the ImageError field of ImageContext. </td></tr>
    <tr><td class="paramname">RETURN_BUFFER_TOO_SMALL</td><td>The caller did not provide a large enough buffer. Extended status information is in the ImageError field of ImageContext. </td></tr>
    <tr><td class="paramname">RETURN_LOAD_ERROR</td><td>The PE/COFF image is an EFI Runtime image with no relocations. Extended status information is in the ImageError field of ImageContext. </td></tr>
    <tr><td class="paramname">RETURN_INVALID_PARAMETER</td><td>The image address is invalid. Extended status information is in the ImageError field of ImageContext. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a2a50888c6100c2d1374d71668a59303f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_base_8h.html#ae30979abefc3ca8dc6f2135dc9cc40be">RETURN_STATUS</a> <a class="el" href="_ebc_2_processor_bind_8h.html#aa3998ed6456694d79e9a45f821f379ed">EFIAPI</a> PeCoffLoaderRelocateImage </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="_base_8h.html#ac2bbd6d630a06a980d9a92ddb9a49928">IN</a> <a class="el" href="_base_8h.html#aec78e7a9e90a406a56f859ee456e8eae">OUT</a> <a class="el" href="struct_p_e___c_o_f_f___l_o_a_d_e_r___i_m_a_g_e___c_o_n_t_e_x_t.html">PE_COFF_LOADER_IMAGE_CONTEXT</a> *&#160;</td>
          <td class="paramname"><em>ImageContext</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Applies relocation fixups to a PE/COFF image that was loaded with <a class="el" href="_pe_coff_lib_8h.html#a2003fb97c41baf50162901cbe9e0f988">PeCoffLoaderLoadImage()</a>.</p>
<p>If the DestinationAddress field of ImageContext is 0, then use the ImageAddress field of ImageContext as the relocation base address. Otherwise, use the DestinationAddress field of ImageContext as the relocation base address. The caller must allocate the relocation fixup log buffer and fill in the FixupData field of ImageContext prior to calling this function.</p>
<p>The ImageRead, Handle, PeCoffHeaderOffset, IsTeImage, Machine, ImageType, ImageAddress, ImageSize, DestinationAddress, RelocationsStripped, SectionAlignment, SizeOfHeaders, DebugDirectoryEntryRva, EntryPoint, FixupDataSize, CodeView, PdbPointer, and FixupData of the ImageContext structure must be valid prior to invoking this service.</p>
<p>If ImageContext is NULL, then <a class="el" href="_debug_lib_8h.html#a76b4aae2259415ea4b7e2c9b34ede0bb">ASSERT()</a>.</p>
<p>Note that if the platform does not maintain coherency between the instruction cache(s) and the data cache(s) in hardware, then the caller is responsible for performing cache maintenance operations prior to transferring control to a PE/COFF image that is loaded using this library.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ImageContext</td><td>The pointer to the image context structure that describes the PE/COFF image that is being relocated.</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">RETURN_SUCCESS</td><td>The PE/COFF image was relocated. Extended status information is in the ImageError field of ImageContext. </td></tr>
    <tr><td class="paramname">RETURN_LOAD_ERROR</td><td>The image in not a valid PE/COFF image. Extended status information is in the ImageError field of ImageContext. </td></tr>
    <tr><td class="paramname">RETURN_UNSUPPORTED</td><td>A relocation record type is not supported. Extended status information is in the ImageError field of ImageContext. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a4827dd41b90b7887445e3c94edbdba84"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_shell_8h.html#aa8ff5bd3c2d6cb377b1dd3bbe3e0cfa8">VOID</a> <a class="el" href="_ebc_2_processor_bind_8h.html#aa3998ed6456694d79e9a45f821f379ed">EFIAPI</a> PeCoffLoaderRelocateImageForRuntime </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="_base_8h.html#ac2bbd6d630a06a980d9a92ddb9a49928">IN</a> <a class="el" href="_base_8h.html#a8557e721a169e9f286709e9b55a64559">PHYSICAL_ADDRESS</a>&#160;</td>
          <td class="paramname"><em>ImageBase</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="_base_8h.html#ac2bbd6d630a06a980d9a92ddb9a49928">IN</a> <a class="el" href="_base_8h.html#a8557e721a169e9f286709e9b55a64559">PHYSICAL_ADDRESS</a>&#160;</td>
          <td class="paramname"><em>VirtImageBase</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="_base_8h.html#ac2bbd6d630a06a980d9a92ddb9a49928">IN</a> <a class="el" href="_ia32_2_processor_bind_8h.html#ac0b1ca9b01db611e0f7f2080a2699135">UINTN</a>&#160;</td>
          <td class="paramname"><em>ImageSize</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="_base_8h.html#ac2bbd6d630a06a980d9a92ddb9a49928">IN</a> <a class="el" href="_shell_8h.html#aa8ff5bd3c2d6cb377b1dd3bbe3e0cfa8">VOID</a> *&#160;</td>
          <td class="paramname"><em>RelocationData</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Reapply fixups on a fixed up PE32/PE32+ image to allow virtual calling at EFI runtime.</p>
<p>This function reapplies relocation fixups to the PE/COFF image specified by ImageBase and ImageSize so the image will execute correctly when the PE/COFF image is mapped to the address specified by VirtualImageBase. RelocationData must be identical to the FiuxupData buffer from the <a class="el" href="struct_p_e___c_o_f_f___l_o_a_d_e_r___i_m_a_g_e___c_o_n_t_e_x_t.html">PE_COFF_LOADER_IMAGE_CONTEXT</a> structure after this PE/COFF image was relocated with <a class="el" href="_pe_coff_lib_8h.html#a2a50888c6100c2d1374d71668a59303f">PeCoffLoaderRelocateImage()</a>.</p>
<p>Note that if the platform does not maintain coherency between the instruction cache(s) and the data cache(s) in hardware, then the caller is responsible for performing cache maintenance operations prior to transferring control to a PE/COFF image that is loaded using this library.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ImageBase</td><td>The base address of a PE/COFF image that has been loaded and relocated into system memory. </td></tr>
    <tr><td class="paramname">VirtImageBase</td><td>The request virtual address that the PE/COFF image is to be fixed up for. </td></tr>
    <tr><td class="paramname">ImageSize</td><td>The size, in bytes, of the PE/COFF image. </td></tr>
    <tr><td class="paramname">RelocationData</td><td>A pointer to the relocation data that was collected when the PE/COFF image was relocated using <a class="el" href="_pe_coff_lib_8h.html#a2a50888c6100c2d1374d71668a59303f">PeCoffLoaderRelocateImage()</a>. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a5e7f95ca7feb12a3aa470b69584c2e75"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_base_8h.html#ae30979abefc3ca8dc6f2135dc9cc40be">RETURN_STATUS</a> <a class="el" href="_ebc_2_processor_bind_8h.html#aa3998ed6456694d79e9a45f821f379ed">EFIAPI</a> PeCoffLoaderUnloadImage </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="_base_8h.html#ac2bbd6d630a06a980d9a92ddb9a49928">IN</a> <a class="el" href="_base_8h.html#aec78e7a9e90a406a56f859ee456e8eae">OUT</a> <a class="el" href="struct_p_e___c_o_f_f___l_o_a_d_e_r___i_m_a_g_e___c_o_n_t_e_x_t.html">PE_COFF_LOADER_IMAGE_CONTEXT</a> *&#160;</td>
          <td class="paramname"><em>ImageContext</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Unloads a loaded PE/COFF image from memory and releases its taken resource. Releases any environment specific resources that were allocated when the image specified by ImageContext was loaded using <a class="el" href="_pe_coff_lib_8h.html#a2003fb97c41baf50162901cbe9e0f988">PeCoffLoaderLoadImage()</a>.</p>
<p>For NT32 emulator, the PE/COFF image loaded by system needs to release. For real platform, the PE/COFF image loaded by Core doesn't needs to be unloaded, this function can simply return RETURN_SUCCESS.</p>
<p>If ImageContext is NULL, then <a class="el" href="_debug_lib_8h.html#a76b4aae2259415ea4b7e2c9b34ede0bb">ASSERT()</a>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ImageContext</td><td>Pointer to the image context structure that describes the PE/COFF image to be unloaded.</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">RETURN_SUCCESS</td><td>The PE/COFF image was unloaded successfully. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_c048fdeadf06364e9318d2cbb3390051.html">MdePkg</a></li><li class="navelem"><a class="el" href="dir_525332e2e2b2ed96fb8f8316b580bf1e.html">Include</a></li><li class="navelem"><a class="el" href="dir_97c67ff71616e8583917a2589d2dcedf.html">Library</a></li><li class="navelem"><a class="el" href="_pe_coff_lib_8h.html">PeCoffLib.h</a></li>
    <li class="footer">Generated on Sun Dec 5 2021 00:12:46 for MdePkg[all] by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.6 </li>
  </ul>
</div>
</body>
</html>
