<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<title>CryptoPkg[all]: CryptoPkg/Include/Library/TlsLib.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">CryptoPkg[all]
   &#160;<span id="projectnumber">0.98</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('_tls_lib_8h.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">TlsLib.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ab66ff71b8104303ab9f0a74e2167508b"><td class="memItemLeft" align="right" valign="top">BOOLEAN EFIAPI&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_tls_lib_8h.html#ab66ff71b8104303ab9f0a74e2167508b">TlsInitialize</a> (VOID)</td></tr>
<tr class="separator:ab66ff71b8104303ab9f0a74e2167508b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a891f2964e7de466ae1d78ee9659dccad"><td class="memItemLeft" align="right" valign="top">VOID EFIAPI&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_tls_lib_8h.html#a891f2964e7de466ae1d78ee9659dccad">TlsCtxFree</a> (IN VOID *TlsCtx)</td></tr>
<tr class="separator:a891f2964e7de466ae1d78ee9659dccad"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0decf360884f218f960c52b533d08d0d"><td class="memItemLeft" align="right" valign="top">VOID *EFIAPI&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_tls_lib_8h.html#a0decf360884f218f960c52b533d08d0d">TlsCtxNew</a> (IN UINT8 MajorVer, IN UINT8 MinorVer)</td></tr>
<tr class="separator:a0decf360884f218f960c52b533d08d0d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5851c71eaf0c37253e7dd6a2b663971b"><td class="memItemLeft" align="right" valign="top">VOID EFIAPI&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_tls_lib_8h.html#a5851c71eaf0c37253e7dd6a2b663971b">TlsFree</a> (IN VOID *Tls)</td></tr>
<tr class="separator:a5851c71eaf0c37253e7dd6a2b663971b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abaaa375086d70bb115e9cb0be5f7796b"><td class="memItemLeft" align="right" valign="top">VOID *EFIAPI&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_tls_lib_8h.html#abaaa375086d70bb115e9cb0be5f7796b">TlsNew</a> (IN VOID *TlsCtx)</td></tr>
<tr class="separator:abaaa375086d70bb115e9cb0be5f7796b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa5e593fc8949675b2f90bb6a14bd7e9e"><td class="memItemLeft" align="right" valign="top">BOOLEAN EFIAPI&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_tls_lib_8h.html#aa5e593fc8949675b2f90bb6a14bd7e9e">TlsInHandshake</a> (IN VOID *Tls)</td></tr>
<tr class="separator:aa5e593fc8949675b2f90bb6a14bd7e9e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abe66121a8e1d06319c64dc428182750f"><td class="memItemLeft" align="right" valign="top">EFI_STATUS EFIAPI&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_tls_lib_8h.html#abe66121a8e1d06319c64dc428182750f">TlsDoHandshake</a> (IN VOID *Tls, IN UINT8 *BufferIn, IN UINTN BufferInSize, OUT UINT8 *BufferOut, IN OUT UINTN *BufferOutSize)</td></tr>
<tr class="separator:abe66121a8e1d06319c64dc428182750f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a768bb34ea2bb96824f5ea47a30416674"><td class="memItemLeft" align="right" valign="top">EFI_STATUS EFIAPI&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_tls_lib_8h.html#a768bb34ea2bb96824f5ea47a30416674">TlsHandleAlert</a> (IN VOID *Tls, IN UINT8 *BufferIn, IN UINTN BufferInSize, OUT UINT8 *BufferOut, IN OUT UINTN *BufferOutSize)</td></tr>
<tr class="separator:a768bb34ea2bb96824f5ea47a30416674"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab5baaff1570fc32cb4954e754153ec13"><td class="memItemLeft" align="right" valign="top">EFI_STATUS EFIAPI&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_tls_lib_8h.html#ab5baaff1570fc32cb4954e754153ec13">TlsCloseNotify</a> (IN VOID *Tls, IN OUT UINT8 *Buffer, IN OUT UINTN *BufferSize)</td></tr>
<tr class="separator:ab5baaff1570fc32cb4954e754153ec13"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4413b9dd6e4caa3cb39a1f7f106c1df8"><td class="memItemLeft" align="right" valign="top">INTN EFIAPI&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_tls_lib_8h.html#a4413b9dd6e4caa3cb39a1f7f106c1df8">TlsCtrlTrafficOut</a> (IN VOID *Tls, IN OUT VOID *Buffer, IN UINTN BufferSize)</td></tr>
<tr class="separator:a4413b9dd6e4caa3cb39a1f7f106c1df8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a24de18df85868fda3af9e295c8e55449"><td class="memItemLeft" align="right" valign="top">INTN EFIAPI&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_tls_lib_8h.html#a24de18df85868fda3af9e295c8e55449">TlsCtrlTrafficIn</a> (IN VOID *Tls, IN VOID *Buffer, IN UINTN BufferSize)</td></tr>
<tr class="separator:a24de18df85868fda3af9e295c8e55449"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9e3dc2acf52eca905ba8417a85ecae32"><td class="memItemLeft" align="right" valign="top">INTN EFIAPI&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_tls_lib_8h.html#a9e3dc2acf52eca905ba8417a85ecae32">TlsRead</a> (IN VOID *Tls, IN OUT VOID *Buffer, IN UINTN BufferSize)</td></tr>
<tr class="separator:a9e3dc2acf52eca905ba8417a85ecae32"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad9debfdd835519b01aadb903b2b7c5e9"><td class="memItemLeft" align="right" valign="top">INTN EFIAPI&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_tls_lib_8h.html#ad9debfdd835519b01aadb903b2b7c5e9">TlsWrite</a> (IN VOID *Tls, IN VOID *Buffer, IN UINTN BufferSize)</td></tr>
<tr class="separator:ad9debfdd835519b01aadb903b2b7c5e9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa9ccea993d60ac8d2c2c5fa8ceb1c0c2"><td class="memItemLeft" align="right" valign="top">EFI_STATUS EFIAPI&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_tls_lib_8h.html#aa9ccea993d60ac8d2c2c5fa8ceb1c0c2">TlsSetVersion</a> (IN VOID *Tls, IN UINT8 MajorVer, IN UINT8 MinorVer)</td></tr>
<tr class="separator:aa9ccea993d60ac8d2c2c5fa8ceb1c0c2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6fa8234b6875a92f1d4cf19e944c4ab4"><td class="memItemLeft" align="right" valign="top">EFI_STATUS EFIAPI&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_tls_lib_8h.html#a6fa8234b6875a92f1d4cf19e944c4ab4">TlsSetConnectionEnd</a> (IN VOID *Tls, IN BOOLEAN IsServer)</td></tr>
<tr class="separator:a6fa8234b6875a92f1d4cf19e944c4ab4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a69502f1e9cfed5f2cbd571e06c70b703"><td class="memItemLeft" align="right" valign="top">EFI_STATUS EFIAPI&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_tls_lib_8h.html#a69502f1e9cfed5f2cbd571e06c70b703">TlsSetCipherList</a> (IN VOID *Tls, IN UINT16 *CipherId, IN UINTN CipherNum)</td></tr>
<tr class="separator:a69502f1e9cfed5f2cbd571e06c70b703"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5798be5da5c348b2fd71edbd45410e2c"><td class="memItemLeft" align="right" valign="top">EFI_STATUS EFIAPI&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_tls_lib_8h.html#a5798be5da5c348b2fd71edbd45410e2c">TlsSetCompressionMethod</a> (IN UINT8 CompMethod)</td></tr>
<tr class="separator:a5798be5da5c348b2fd71edbd45410e2c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a85ea82a94ee9fea1eb99a4f58a7a04b8"><td class="memItemLeft" align="right" valign="top">VOID EFIAPI&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_tls_lib_8h.html#a85ea82a94ee9fea1eb99a4f58a7a04b8">TlsSetVerify</a> (IN VOID *Tls, IN UINT32 VerifyMode)</td></tr>
<tr class="separator:a85ea82a94ee9fea1eb99a4f58a7a04b8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a23bc6107cee56b42c0e479303950a077"><td class="memItemLeft" align="right" valign="top">EFI_STATUS EFIAPI&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_tls_lib_8h.html#a23bc6107cee56b42c0e479303950a077">TlsSetVerifyHost</a> (IN VOID *Tls, IN UINT32 Flags, IN CHAR8 *HostName)</td></tr>
<tr class="separator:a23bc6107cee56b42c0e479303950a077"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a70fac3ffe9f1fbb1cd25e0289c27ccdf"><td class="memItemLeft" align="right" valign="top">EFI_STATUS EFIAPI&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_tls_lib_8h.html#a70fac3ffe9f1fbb1cd25e0289c27ccdf">TlsSetSessionId</a> (IN VOID *Tls, IN UINT8 *SessionId, IN UINT16 SessionIdLen)</td></tr>
<tr class="separator:a70fac3ffe9f1fbb1cd25e0289c27ccdf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a62e8700614e72150c8ebdab3a051d048"><td class="memItemLeft" align="right" valign="top">EFI_STATUS EFIAPI&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_tls_lib_8h.html#a62e8700614e72150c8ebdab3a051d048">TlsSetCaCertificate</a> (IN VOID *Tls, IN VOID *Data, IN UINTN DataSize)</td></tr>
<tr class="separator:a62e8700614e72150c8ebdab3a051d048"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7420e6e3ca18f0cbe867e3091fd145f2"><td class="memItemLeft" align="right" valign="top">EFI_STATUS EFIAPI&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_tls_lib_8h.html#a7420e6e3ca18f0cbe867e3091fd145f2">TlsSetHostPublicCert</a> (IN VOID *Tls, IN VOID *Data, IN UINTN DataSize)</td></tr>
<tr class="separator:a7420e6e3ca18f0cbe867e3091fd145f2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a741dc27e28b5bec5474ba5021f6468b2"><td class="memItemLeft" align="right" valign="top">EFI_STATUS EFIAPI&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_tls_lib_8h.html#a741dc27e28b5bec5474ba5021f6468b2">TlsSetHostPrivateKey</a> (IN VOID *Tls, IN VOID *Data, IN UINTN DataSize)</td></tr>
<tr class="separator:a741dc27e28b5bec5474ba5021f6468b2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3663d1b6e9c12f3ac1e161d94b44858c"><td class="memItemLeft" align="right" valign="top">EFI_STATUS EFIAPI&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_tls_lib_8h.html#a3663d1b6e9c12f3ac1e161d94b44858c">TlsSetCertRevocationList</a> (IN VOID *Data, IN UINTN DataSize)</td></tr>
<tr class="separator:a3663d1b6e9c12f3ac1e161d94b44858c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac34e3862abb6e69700028a9ceb938b0f"><td class="memItemLeft" align="right" valign="top">UINT16 EFIAPI&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_tls_lib_8h.html#ac34e3862abb6e69700028a9ceb938b0f">TlsGetVersion</a> (IN VOID *Tls)</td></tr>
<tr class="separator:ac34e3862abb6e69700028a9ceb938b0f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a82c05a307f85d9fe9b04c81a21ff4b24"><td class="memItemLeft" align="right" valign="top">UINT8 EFIAPI&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_tls_lib_8h.html#a82c05a307f85d9fe9b04c81a21ff4b24">TlsGetConnectionEnd</a> (IN VOID *Tls)</td></tr>
<tr class="separator:a82c05a307f85d9fe9b04c81a21ff4b24"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a353306dd7dff3d553ec8f19ec0855386"><td class="memItemLeft" align="right" valign="top">EFI_STATUS EFIAPI&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_tls_lib_8h.html#a353306dd7dff3d553ec8f19ec0855386">TlsGetCurrentCipher</a> (IN VOID *Tls, IN OUT UINT16 *CipherId)</td></tr>
<tr class="separator:a353306dd7dff3d553ec8f19ec0855386"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6f870bdba39f3aec3ee7d82a1f6af042"><td class="memItemLeft" align="right" valign="top">EFI_STATUS EFIAPI&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_tls_lib_8h.html#a6f870bdba39f3aec3ee7d82a1f6af042">TlsGetCurrentCompressionId</a> (IN VOID *Tls, IN OUT UINT8 *CompressionId)</td></tr>
<tr class="separator:a6f870bdba39f3aec3ee7d82a1f6af042"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a31c59b3a13a33988bedd614dfb39be00"><td class="memItemLeft" align="right" valign="top">UINT32 EFIAPI&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_tls_lib_8h.html#a31c59b3a13a33988bedd614dfb39be00">TlsGetVerify</a> (IN VOID *Tls)</td></tr>
<tr class="separator:a31c59b3a13a33988bedd614dfb39be00"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abff553db3977a579168dcc4beaf0e8e0"><td class="memItemLeft" align="right" valign="top">EFI_STATUS EFIAPI&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_tls_lib_8h.html#abff553db3977a579168dcc4beaf0e8e0">TlsGetSessionId</a> (IN VOID *Tls, IN OUT UINT8 *SessionId, IN OUT UINT16 *SessionIdLen)</td></tr>
<tr class="separator:abff553db3977a579168dcc4beaf0e8e0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a975a17d5cf41206210fdec7b524faf5c"><td class="memItemLeft" align="right" valign="top">VOID EFIAPI&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_tls_lib_8h.html#a975a17d5cf41206210fdec7b524faf5c">TlsGetClientRandom</a> (IN VOID *Tls, IN OUT UINT8 *ClientRandom)</td></tr>
<tr class="separator:a975a17d5cf41206210fdec7b524faf5c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0588de79a934ffb48f80e2280f03b59d"><td class="memItemLeft" align="right" valign="top">VOID EFIAPI&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_tls_lib_8h.html#a0588de79a934ffb48f80e2280f03b59d">TlsGetServerRandom</a> (IN VOID *Tls, IN OUT UINT8 *ServerRandom)</td></tr>
<tr class="separator:a0588de79a934ffb48f80e2280f03b59d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2bb284b8fa6dcbd3c8ba522c4ee5506c"><td class="memItemLeft" align="right" valign="top">EFI_STATUS EFIAPI&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_tls_lib_8h.html#a2bb284b8fa6dcbd3c8ba522c4ee5506c">TlsGetKeyMaterial</a> (IN VOID *Tls, IN OUT UINT8 *KeyMaterial)</td></tr>
<tr class="separator:a2bb284b8fa6dcbd3c8ba522c4ee5506c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae45e2ad2a01041c2c400506083fd1cf9"><td class="memItemLeft" align="right" valign="top">EFI_STATUS EFIAPI&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_tls_lib_8h.html#ae45e2ad2a01041c2c400506083fd1cf9">TlsGetCaCertificate</a> (IN VOID *Tls, OUT VOID *Data, IN OUT UINTN *DataSize)</td></tr>
<tr class="separator:ae45e2ad2a01041c2c400506083fd1cf9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a17e8dc9cbdbe443cce5711abf3a02377"><td class="memItemLeft" align="right" valign="top">EFI_STATUS EFIAPI&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_tls_lib_8h.html#a17e8dc9cbdbe443cce5711abf3a02377">TlsGetHostPublicCert</a> (IN VOID *Tls, OUT VOID *Data, IN OUT UINTN *DataSize)</td></tr>
<tr class="separator:a17e8dc9cbdbe443cce5711abf3a02377"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af149de2ba5f373ce929bbebb2b553378"><td class="memItemLeft" align="right" valign="top">EFI_STATUS EFIAPI&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_tls_lib_8h.html#af149de2ba5f373ce929bbebb2b553378">TlsGetHostPrivateKey</a> (IN VOID *Tls, OUT VOID *Data, IN OUT UINTN *DataSize)</td></tr>
<tr class="separator:af149de2ba5f373ce929bbebb2b553378"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a40e4d8077d351bc3866b5945a4d11207"><td class="memItemLeft" align="right" valign="top">EFI_STATUS EFIAPI&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_tls_lib_8h.html#a40e4d8077d351bc3866b5945a4d11207">TlsGetCertRevocationList</a> (OUT VOID *Data, IN OUT UINTN *DataSize)</td></tr>
<tr class="separator:a40e4d8077d351bc3866b5945a4d11207"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Defines TLS Library APIs.</p>
<p>Copyright (c) 2016 - 2017, Intel Corporation. All rights reserved.<br/>
 SPDX-License-Identifier: BSD-2-Clause-Patent </p>
</div><h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="ab5baaff1570fc32cb4954e754153ec13"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">EFI_STATUS EFIAPI TlsCloseNotify </td>
          <td>(</td>
          <td class="paramtype">IN VOID *&#160;</td>
          <td class="paramname"><em>Tls</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IN OUT UINT8 *&#160;</td>
          <td class="paramname"><em>Buffer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IN OUT UINTN *&#160;</td>
          <td class="paramname"><em>BufferSize</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Build the CloseNotify packet.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">Tls</td><td>Pointer to the TLS object for state checking. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">Buffer</td><td>Pointer to the buffer to hold the built packet. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">BufferSize</td><td>Pointer to the buffer size in bytes. On input, it is the buffer size provided by the caller. On output, it is the buffer size in fact needed to contain the packet.</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">EFI_SUCCESS</td><td>The required TLS packet is built successfully. </td></tr>
    <tr><td class="paramname">EFI_INVALID_PARAMETER</td><td>One or more of the following conditions is TRUE: Tls is NULL. BufferSize is NULL. Buffer is NULL if *BufferSize is not zero. </td></tr>
    <tr><td class="paramname">EFI_BUFFER_TOO_SMALL</td><td>BufferSize is too small to hold the response packet. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a24de18df85868fda3af9e295c8e55449"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">INTN EFIAPI TlsCtrlTrafficIn </td>
          <td>(</td>
          <td class="paramtype">IN VOID *&#160;</td>
          <td class="paramname"><em>Tls</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IN VOID *&#160;</td>
          <td class="paramname"><em>Buffer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IN UINTN&#160;</td>
          <td class="paramname"><em>BufferSize</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Attempts to write data from the buffer to TLS object.</p>
<p>This function will attempt to write BufferSize bytes data from the Buffer to the TLS object.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">Tls</td><td>Pointer to the TLS object. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">Buffer</td><td>Pointer to the data buffer. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">BufferSize</td><td>The size of Buffer in bytes.</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">&gt;0</td><td>The amount of data successfully written to the TLS object. </td></tr>
    <tr><td class="paramname">&lt;=0</td><td>No data was successfully written. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a4413b9dd6e4caa3cb39a1f7f106c1df8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">INTN EFIAPI TlsCtrlTrafficOut </td>
          <td>(</td>
          <td class="paramtype">IN VOID *&#160;</td>
          <td class="paramname"><em>Tls</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IN OUT VOID *&#160;</td>
          <td class="paramname"><em>Buffer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IN UINTN&#160;</td>
          <td class="paramname"><em>BufferSize</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Attempts to read bytes from one TLS object and places the data in Buffer.</p>
<p>This function will attempt to read BufferSize bytes from the TLS object and places the data in Buffer.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">Tls</td><td>Pointer to the TLS object. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">Buffer</td><td>Pointer to the buffer to store the data. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">BufferSize</td><td>The size of Buffer in bytes.</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">&gt;0</td><td>The amount of data successfully read from the TLS object. </td></tr>
    <tr><td class="paramname">&lt;=0</td><td>No data was successfully read. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a891f2964e7de466ae1d78ee9659dccad"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">VOID EFIAPI TlsCtxFree </td>
          <td>(</td>
          <td class="paramtype">IN VOID *&#160;</td>
          <td class="paramname"><em>TlsCtx</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Free an allocated SSL_CTX object.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">TlsCtx</td><td>Pointer to the SSL_CTX object to be released. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a0decf360884f218f960c52b533d08d0d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">VOID* EFIAPI TlsCtxNew </td>
          <td>(</td>
          <td class="paramtype">IN UINT8&#160;</td>
          <td class="paramname"><em>MajorVer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IN UINT8&#160;</td>
          <td class="paramname"><em>MinorVer</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Creates a new SSL_CTX object as framework to establish TLS/SSL enabled connections.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">MajorVer</td><td>Major Version of TLS/SSL Protocol. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">MinorVer</td><td>Minor Version of TLS/SSL Protocol.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Pointer to an allocated SSL_CTX object. If the creation failed, <a class="el" href="_tls_lib_8h.html#a0decf360884f218f960c52b533d08d0d">TlsCtxNew()</a> returns NULL. </dd></dl>

</div>
</div>
<a class="anchor" id="abe66121a8e1d06319c64dc428182750f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">EFI_STATUS EFIAPI TlsDoHandshake </td>
          <td>(</td>
          <td class="paramtype">IN VOID *&#160;</td>
          <td class="paramname"><em>Tls</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IN UINT8 *&#160;</td>
          <td class="paramname"><em>BufferIn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IN UINTN&#160;</td>
          <td class="paramname"><em>BufferInSize</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">OUT UINT8 *&#160;</td>
          <td class="paramname"><em>BufferOut</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IN OUT UINTN *&#160;</td>
          <td class="paramname"><em>BufferOutSize</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Perform a TLS/SSL handshake.</p>
<p>This function will perform a TLS/SSL handshake.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">Tls</td><td>Pointer to the TLS object for handshake operation. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">BufferIn</td><td>Pointer to the most recently received TLS Handshake packet. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">BufferInSize</td><td>Packet size in bytes for the most recently received TLS Handshake packet. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">BufferOut</td><td>Pointer to the buffer to hold the built packet. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">BufferOutSize</td><td>Pointer to the buffer size in bytes. On input, it is the buffer size provided by the caller. On output, it is the buffer size in fact needed to contain the packet.</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">EFI_SUCCESS</td><td>The required TLS packet is built successfully. </td></tr>
    <tr><td class="paramname">EFI_INVALID_PARAMETER</td><td>One or more of the following conditions is TRUE: Tls is NULL. BufferIn is NULL but BufferInSize is NOT 0. BufferInSize is 0 but BufferIn is NOT NULL. BufferOutSize is NULL. BufferOut is NULL if *BufferOutSize is not zero. </td></tr>
    <tr><td class="paramname">EFI_BUFFER_TOO_SMALL</td><td>BufferOutSize is too small to hold the response packet. </td></tr>
    <tr><td class="paramname">EFI_ABORTED</td><td>Something wrong during handshake. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a5851c71eaf0c37253e7dd6a2b663971b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">VOID EFIAPI TlsFree </td>
          <td>(</td>
          <td class="paramtype">IN VOID *&#160;</td>
          <td class="paramname"><em>Tls</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Free an allocated TLS object.</p>
<p>This function removes the TLS object pointed to by Tls and frees up the allocated memory. If Tls is NULL, nothing is done.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">Tls</td><td>Pointer to the TLS object to be freed. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="ae45e2ad2a01041c2c400506083fd1cf9"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">EFI_STATUS EFIAPI TlsGetCaCertificate </td>
          <td>(</td>
          <td class="paramtype">IN VOID *&#160;</td>
          <td class="paramname"><em>Tls</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">OUT VOID *&#160;</td>
          <td class="paramname"><em>Data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IN OUT UINTN *&#160;</td>
          <td class="paramname"><em>DataSize</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Gets the CA Certificate from the cert store.</p>
<p>This function returns the CA certificate for the chosen TLS connection.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">Tls</td><td>Pointer to the TLS object. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">Data</td><td>Pointer to the data buffer to receive the CA certificate data sent to the client. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">DataSize</td><td>The size of data buffer in bytes.</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">EFI_SUCCESS</td><td>The operation succeeded. </td></tr>
    <tr><td class="paramname">EFI_UNSUPPORTED</td><td>This function is not supported. </td></tr>
    <tr><td class="paramname">EFI_BUFFER_TOO_SMALL</td><td>The Data is too small to hold the data. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a40e4d8077d351bc3866b5945a4d11207"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">EFI_STATUS EFIAPI TlsGetCertRevocationList </td>
          <td>(</td>
          <td class="paramtype">OUT VOID *&#160;</td>
          <td class="paramname"><em>Data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IN OUT UINTN *&#160;</td>
          <td class="paramname"><em>DataSize</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Gets the CA-supplied certificate revocation list data set in the specified TLS object.</p>
<p>This function returns the CA-supplied certificate revocation list data which was currently set in the specified TLS object.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">Data</td><td>Pointer to the data buffer to receive the CRL data. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">DataSize</td><td>The size of data buffer in bytes.</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">EFI_SUCCESS</td><td>The operation succeeded. </td></tr>
    <tr><td class="paramname">EFI_UNSUPPORTED</td><td>This function is not supported. </td></tr>
    <tr><td class="paramname">EFI_BUFFER_TOO_SMALL</td><td>The Data is too small to hold the data. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a975a17d5cf41206210fdec7b524faf5c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">VOID EFIAPI TlsGetClientRandom </td>
          <td>(</td>
          <td class="paramtype">IN VOID *&#160;</td>
          <td class="paramname"><em>Tls</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IN OUT UINT8 *&#160;</td>
          <td class="paramname"><em>ClientRandom</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Gets the client random data used in the specified TLS connection.</p>
<p>This function returns the TLS/SSL client random data currently used in the specified TLS connection.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">Tls</td><td>Pointer to the TLS object. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">ClientRandom</td><td>Buffer to contain the returned client random data (32 bytes). </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a82c05a307f85d9fe9b04c81a21ff4b24"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">UINT8 EFIAPI TlsGetConnectionEnd </td>
          <td>(</td>
          <td class="paramtype">IN VOID *&#160;</td>
          <td class="paramname"><em>Tls</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Gets the connection end of the specified TLS connection.</p>
<p>This function returns the connection end (as client or as server) used by the specified TLS connection.</p>
<p>If Tls is NULL, then ASSERT().</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">Tls</td><td>Pointer to the TLS object.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The connection end used by the specified TLS connection. </dd></dl>

</div>
</div>
<a class="anchor" id="a353306dd7dff3d553ec8f19ec0855386"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">EFI_STATUS EFIAPI TlsGetCurrentCipher </td>
          <td>(</td>
          <td class="paramtype">IN VOID *&#160;</td>
          <td class="paramname"><em>Tls</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IN OUT UINT16 *&#160;</td>
          <td class="paramname"><em>CipherId</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Gets the cipher suite used by the specified TLS connection.</p>
<p>This function returns current cipher suite used by the specified TLS connection.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">Tls</td><td>Pointer to the TLS object. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">CipherId</td><td>The cipher suite used by the TLS object.</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">EFI_SUCCESS</td><td>The cipher suite was returned successfully. </td></tr>
    <tr><td class="paramname">EFI_INVALID_PARAMETER</td><td>The parameter is invalid. </td></tr>
    <tr><td class="paramname">EFI_UNSUPPORTED</td><td>Unsupported cipher suite. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a6f870bdba39f3aec3ee7d82a1f6af042"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">EFI_STATUS EFIAPI TlsGetCurrentCompressionId </td>
          <td>(</td>
          <td class="paramtype">IN VOID *&#160;</td>
          <td class="paramname"><em>Tls</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IN OUT UINT8 *&#160;</td>
          <td class="paramname"><em>CompressionId</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Gets the compression methods used by the specified TLS connection.</p>
<p>This function returns current integrated compression methods used by the specified TLS connection.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">Tls</td><td>Pointer to the TLS object. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">CompressionId</td><td>The current compression method used by the TLS object.</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">EFI_SUCCESS</td><td>The compression method was returned successfully. </td></tr>
    <tr><td class="paramname">EFI_INVALID_PARAMETER</td><td>The parameter is invalid. </td></tr>
    <tr><td class="paramname">EFI_ABORTED</td><td>Invalid Compression method. </td></tr>
    <tr><td class="paramname">EFI_UNSUPPORTED</td><td>This function is not supported. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="af149de2ba5f373ce929bbebb2b553378"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">EFI_STATUS EFIAPI TlsGetHostPrivateKey </td>
          <td>(</td>
          <td class="paramtype">IN VOID *&#160;</td>
          <td class="paramname"><em>Tls</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">OUT VOID *&#160;</td>
          <td class="paramname"><em>Data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IN OUT UINTN *&#160;</td>
          <td class="paramname"><em>DataSize</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Gets the local private key set in the specified TLS object.</p>
<p>This function returns the local private key data which was currently set in the specified TLS object.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">Tls</td><td>Pointer to the TLS object. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">Data</td><td>Pointer to the data buffer to receive the local private key data. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">DataSize</td><td>The size of data buffer in bytes.</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">EFI_SUCCESS</td><td>The operation succeeded. </td></tr>
    <tr><td class="paramname">EFI_UNSUPPORTED</td><td>This function is not supported. </td></tr>
    <tr><td class="paramname">EFI_BUFFER_TOO_SMALL</td><td>The Data is too small to hold the data. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a17e8dc9cbdbe443cce5711abf3a02377"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">EFI_STATUS EFIAPI TlsGetHostPublicCert </td>
          <td>(</td>
          <td class="paramtype">IN VOID *&#160;</td>
          <td class="paramname"><em>Tls</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">OUT VOID *&#160;</td>
          <td class="paramname"><em>Data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IN OUT UINTN *&#160;</td>
          <td class="paramname"><em>DataSize</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Gets the local public Certificate set in the specified TLS object.</p>
<p>This function returns the local public certificate which was currently set in the specified TLS object.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">Tls</td><td>Pointer to the TLS object. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">Data</td><td>Pointer to the data buffer to receive the local public certificate. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">DataSize</td><td>The size of data buffer in bytes.</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">EFI_SUCCESS</td><td>The operation succeeded. </td></tr>
    <tr><td class="paramname">EFI_INVALID_PARAMETER</td><td>The parameter is invalid. </td></tr>
    <tr><td class="paramname">EFI_NOT_FOUND</td><td>The certificate is not found. </td></tr>
    <tr><td class="paramname">EFI_BUFFER_TOO_SMALL</td><td>The Data is too small to hold the data. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a2bb284b8fa6dcbd3c8ba522c4ee5506c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">EFI_STATUS EFIAPI TlsGetKeyMaterial </td>
          <td>(</td>
          <td class="paramtype">IN VOID *&#160;</td>
          <td class="paramname"><em>Tls</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IN OUT UINT8 *&#160;</td>
          <td class="paramname"><em>KeyMaterial</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Gets the master key data used in the specified TLS connection.</p>
<p>This function returns the TLS/SSL master key material currently used in the specified TLS connection.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">Tls</td><td>Pointer to the TLS object. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">KeyMaterial</td><td>Buffer to contain the returned key material.</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">EFI_SUCCESS</td><td>Key material was returned successfully. </td></tr>
    <tr><td class="paramname">EFI_INVALID_PARAMETER</td><td>The parameter is invalid. </td></tr>
    <tr><td class="paramname">EFI_UNSUPPORTED</td><td>Invalid TLS/SSL session. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a0588de79a934ffb48f80e2280f03b59d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">VOID EFIAPI TlsGetServerRandom </td>
          <td>(</td>
          <td class="paramtype">IN VOID *&#160;</td>
          <td class="paramname"><em>Tls</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IN OUT UINT8 *&#160;</td>
          <td class="paramname"><em>ServerRandom</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Gets the server random data used in the specified TLS connection.</p>
<p>This function returns the TLS/SSL server random data currently used in the specified TLS connection.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">Tls</td><td>Pointer to the TLS object. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">ServerRandom</td><td>Buffer to contain the returned server random data (32 bytes). </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="abff553db3977a579168dcc4beaf0e8e0"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">EFI_STATUS EFIAPI TlsGetSessionId </td>
          <td>(</td>
          <td class="paramtype">IN VOID *&#160;</td>
          <td class="paramname"><em>Tls</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IN OUT UINT8 *&#160;</td>
          <td class="paramname"><em>SessionId</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IN OUT UINT16 *&#160;</td>
          <td class="paramname"><em>SessionIdLen</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Gets the session ID used by the specified TLS connection.</p>
<p>This function returns the TLS/SSL session ID currently used by the specified TLS connection.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">Tls</td><td>Pointer to the TLS object. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">SessionId</td><td>Buffer to contain the returned session ID. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">SessionIdLen</td><td>The length of Session ID in bytes.</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">EFI_SUCCESS</td><td>The Session ID was returned successfully. </td></tr>
    <tr><td class="paramname">EFI_INVALID_PARAMETER</td><td>The parameter is invalid. </td></tr>
    <tr><td class="paramname">EFI_UNSUPPORTED</td><td>Invalid TLS/SSL session. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a31c59b3a13a33988bedd614dfb39be00"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">UINT32 EFIAPI TlsGetVerify </td>
          <td>(</td>
          <td class="paramtype">IN VOID *&#160;</td>
          <td class="paramname"><em>Tls</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Gets the verification mode currently set in the TLS connection.</p>
<p>This function returns the peer verification mode currently set in the specified TLS connection.</p>
<p>If Tls is NULL, then ASSERT().</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">Tls</td><td>Pointer to the TLS object.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The verification mode set in the specified TLS connection. </dd></dl>

</div>
</div>
<a class="anchor" id="ac34e3862abb6e69700028a9ceb938b0f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">UINT16 EFIAPI TlsGetVersion </td>
          <td>(</td>
          <td class="paramtype">IN VOID *&#160;</td>
          <td class="paramname"><em>Tls</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Gets the protocol version used by the specified TLS connection.</p>
<p>This function returns the protocol version used by the specified TLS connection.</p>
<p>If Tls is NULL, then ASSERT().</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">Tls</td><td>Pointer to the TLS object.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The protocol version of the specified TLS connection. </dd></dl>

</div>
</div>
<a class="anchor" id="a768bb34ea2bb96824f5ea47a30416674"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">EFI_STATUS EFIAPI TlsHandleAlert </td>
          <td>(</td>
          <td class="paramtype">IN VOID *&#160;</td>
          <td class="paramname"><em>Tls</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IN UINT8 *&#160;</td>
          <td class="paramname"><em>BufferIn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IN UINTN&#160;</td>
          <td class="paramname"><em>BufferInSize</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">OUT UINT8 *&#160;</td>
          <td class="paramname"><em>BufferOut</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IN OUT UINTN *&#160;</td>
          <td class="paramname"><em>BufferOutSize</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Handle Alert message recorded in BufferIn. If BufferIn is NULL and BufferInSize is zero, TLS session has errors and the response packet needs to be Alert message based on error type.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">Tls</td><td>Pointer to the TLS object for state checking. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">BufferIn</td><td>Pointer to the most recently received TLS Alert packet. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">BufferInSize</td><td>Packet size in bytes for the most recently received TLS Alert packet. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">BufferOut</td><td>Pointer to the buffer to hold the built packet. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">BufferOutSize</td><td>Pointer to the buffer size in bytes. On input, it is the buffer size provided by the caller. On output, it is the buffer size in fact needed to contain the packet.</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">EFI_SUCCESS</td><td>The required TLS packet is built successfully. </td></tr>
    <tr><td class="paramname">EFI_INVALID_PARAMETER</td><td>One or more of the following conditions is TRUE: Tls is NULL. BufferIn is NULL but BufferInSize is NOT 0. BufferInSize is 0 but BufferIn is NOT NULL. BufferOutSize is NULL. BufferOut is NULL if *BufferOutSize is not zero. </td></tr>
    <tr><td class="paramname">EFI_ABORTED</td><td>An error occurred. </td></tr>
    <tr><td class="paramname">EFI_BUFFER_TOO_SMALL</td><td>BufferOutSize is too small to hold the response packet. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="aa5e593fc8949675b2f90bb6a14bd7e9e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">BOOLEAN EFIAPI TlsInHandshake </td>
          <td>(</td>
          <td class="paramtype">IN VOID *&#160;</td>
          <td class="paramname"><em>Tls</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Checks if the TLS handshake was done.</p>
<p>This function will check if the specified TLS handshake was done.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">Tls</td><td>Pointer to the TLS object for handshake state checking.</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">TRUE</td><td>The TLS handshake was done. </td></tr>
    <tr><td class="paramname">FALSE</td><td>The TLS handshake was not done. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="ab66ff71b8104303ab9f0a74e2167508b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">BOOLEAN EFIAPI TlsInitialize </td>
          <td>(</td>
          <td class="paramtype">VOID&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Initializes the OpenSSL library.</p>
<p>This function registers ciphers and digests used directly and indirectly by SSL/TLS, and initializes the readable error messages. This function must be called before any other action takes places.</p>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">TRUE</td><td>The OpenSSL library has been initialized. </td></tr>
    <tr><td class="paramname">FALSE</td><td>Failed to initialize the OpenSSL library. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="abaaa375086d70bb115e9cb0be5f7796b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">VOID* EFIAPI TlsNew </td>
          <td>(</td>
          <td class="paramtype">IN VOID *&#160;</td>
          <td class="paramname"><em>TlsCtx</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Create a new TLS object for a connection.</p>
<p>This function creates a new TLS object for a connection. The new object inherits the setting of the underlying context TlsCtx: connection method, options, verification setting.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">TlsCtx</td><td>Pointer to the SSL_CTX object.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Pointer to an allocated SSL object. If the creation failed, <a class="el" href="_tls_lib_8h.html#abaaa375086d70bb115e9cb0be5f7796b">TlsNew()</a> returns NULL. </dd></dl>

</div>
</div>
<a class="anchor" id="a9e3dc2acf52eca905ba8417a85ecae32"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">INTN EFIAPI TlsRead </td>
          <td>(</td>
          <td class="paramtype">IN VOID *&#160;</td>
          <td class="paramname"><em>Tls</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IN OUT VOID *&#160;</td>
          <td class="paramname"><em>Buffer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IN UINTN&#160;</td>
          <td class="paramname"><em>BufferSize</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Attempts to read bytes from the specified TLS connection into the buffer.</p>
<p>This function tries to read BufferSize bytes data from the specified TLS connection into the Buffer.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">Tls</td><td>Pointer to the TLS connection for data reading. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">Buffer</td><td>Pointer to the data buffer. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">BufferSize</td><td>The size of Buffer in bytes.</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">&gt;0</td><td>The read operation was successful, and return value is the number of bytes actually read from the TLS connection. </td></tr>
    <tr><td class="paramname">&lt;=0</td><td>The read operation was not successful. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a62e8700614e72150c8ebdab3a051d048"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">EFI_STATUS EFIAPI TlsSetCaCertificate </td>
          <td>(</td>
          <td class="paramtype">IN VOID *&#160;</td>
          <td class="paramname"><em>Tls</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IN VOID *&#160;</td>
          <td class="paramname"><em>Data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IN UINTN&#160;</td>
          <td class="paramname"><em>DataSize</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Adds the CA to the cert store when requesting Server or Client authentication.</p>
<p>This function adds the CA certificate to the list of CAs when requesting Server or Client authentication for the chosen TLS connection.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">Tls</td><td>Pointer to the TLS object. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">Data</td><td>Pointer to the data buffer of a DER-encoded binary X.509 certificate or PEM-encoded X.509 certificate. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">DataSize</td><td>The size of data buffer in bytes.</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">EFI_SUCCESS</td><td>The operation succeeded. </td></tr>
    <tr><td class="paramname">EFI_INVALID_PARAMETER</td><td>The parameter is invalid. </td></tr>
    <tr><td class="paramname">EFI_OUT_OF_RESOURCES</td><td>Required resources could not be allocated. </td></tr>
    <tr><td class="paramname">EFI_ABORTED</td><td>Invalid X.509 certificate. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a3663d1b6e9c12f3ac1e161d94b44858c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">EFI_STATUS EFIAPI TlsSetCertRevocationList </td>
          <td>(</td>
          <td class="paramtype">IN VOID *&#160;</td>
          <td class="paramname"><em>Data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IN UINTN&#160;</td>
          <td class="paramname"><em>DataSize</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Adds the CA-supplied certificate revocation list for certificate validation.</p>
<p>This function adds the CA-supplied certificate revocation list data for certificate validity checking.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">Data</td><td>Pointer to the data buffer of a DER-encoded CRL data. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">DataSize</td><td>The size of data buffer in bytes.</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">EFI_SUCCESS</td><td>The operation succeeded. </td></tr>
    <tr><td class="paramname">EFI_UNSUPPORTED</td><td>This function is not supported. </td></tr>
    <tr><td class="paramname">EFI_ABORTED</td><td>Invalid CRL data. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a69502f1e9cfed5f2cbd571e06c70b703"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">EFI_STATUS EFIAPI TlsSetCipherList </td>
          <td>(</td>
          <td class="paramtype">IN VOID *&#160;</td>
          <td class="paramname"><em>Tls</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IN UINT16 *&#160;</td>
          <td class="paramname"><em>CipherId</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IN UINTN&#160;</td>
          <td class="paramname"><em>CipherNum</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Set the ciphers list to be used by the TLS object.</p>
<p>This function sets the ciphers for use by a specified TLS object.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">Tls</td><td>Pointer to a TLS object. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">CipherId</td><td>Array of UINT16 cipher identifiers. Each UINT16 cipher identifier comes from the TLS Cipher Suite Registry of the IANA, interpreting Byte1 and Byte2 in network (big endian) byte order. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">CipherNum</td><td>The number of cipher in the list.</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">EFI_SUCCESS</td><td>The ciphers list was set successfully. </td></tr>
    <tr><td class="paramname">EFI_INVALID_PARAMETER</td><td>The parameter is invalid. </td></tr>
    <tr><td class="paramname">EFI_UNSUPPORTED</td><td>No supported TLS cipher was found in CipherId. </td></tr>
    <tr><td class="paramname">EFI_OUT_OF_RESOURCES</td><td>Memory allocation failed. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a5798be5da5c348b2fd71edbd45410e2c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">EFI_STATUS EFIAPI TlsSetCompressionMethod </td>
          <td>(</td>
          <td class="paramtype">IN UINT8&#160;</td>
          <td class="paramname"><em>CompMethod</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Set the compression method for TLS/SSL operations.</p>
<p>This function handles TLS/SSL integrated compression methods.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">CompMethod</td><td>The compression method ID.</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">EFI_SUCCESS</td><td>The compression method for the communication was set successfully. </td></tr>
    <tr><td class="paramname">EFI_UNSUPPORTED</td><td>Unsupported compression method. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a6fa8234b6875a92f1d4cf19e944c4ab4"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">EFI_STATUS EFIAPI TlsSetConnectionEnd </td>
          <td>(</td>
          <td class="paramtype">IN VOID *&#160;</td>
          <td class="paramname"><em>Tls</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IN BOOLEAN&#160;</td>
          <td class="paramname"><em>IsServer</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Set TLS object to work in client or server mode.</p>
<p>This function prepares a TLS object to work in client or server mode.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">Tls</td><td>Pointer to a TLS object. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">IsServer</td><td>Work in server mode.</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">EFI_SUCCESS</td><td>The TLS/SSL work mode was set successfully. </td></tr>
    <tr><td class="paramname">EFI_INVALID_PARAMETER</td><td>The parameter is invalid. </td></tr>
    <tr><td class="paramname">EFI_UNSUPPORTED</td><td>Unsupported TLS/SSL work mode. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a741dc27e28b5bec5474ba5021f6468b2"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">EFI_STATUS EFIAPI TlsSetHostPrivateKey </td>
          <td>(</td>
          <td class="paramtype">IN VOID *&#160;</td>
          <td class="paramname"><em>Tls</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IN VOID *&#160;</td>
          <td class="paramname"><em>Data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IN UINTN&#160;</td>
          <td class="paramname"><em>DataSize</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Adds the local private key to the specified TLS object.</p>
<p>This function adds the local private key (PEM-encoded RSA or PKCS#8 private key) into the specified TLS object for TLS negotiation.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">Tls</td><td>Pointer to the TLS object. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">Data</td><td>Pointer to the data buffer of a PEM-encoded RSA or PKCS#8 private key. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">DataSize</td><td>The size of data buffer in bytes.</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">EFI_SUCCESS</td><td>The operation succeeded. </td></tr>
    <tr><td class="paramname">EFI_UNSUPPORTED</td><td>This function is not supported. </td></tr>
    <tr><td class="paramname">EFI_ABORTED</td><td>Invalid private key data. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a7420e6e3ca18f0cbe867e3091fd145f2"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">EFI_STATUS EFIAPI TlsSetHostPublicCert </td>
          <td>(</td>
          <td class="paramtype">IN VOID *&#160;</td>
          <td class="paramname"><em>Tls</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IN VOID *&#160;</td>
          <td class="paramname"><em>Data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IN UINTN&#160;</td>
          <td class="paramname"><em>DataSize</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Loads the local public certificate into the specified TLS object.</p>
<p>This function loads the X.509 certificate into the specified TLS object for TLS negotiation.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">Tls</td><td>Pointer to the TLS object. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">Data</td><td>Pointer to the data buffer of a DER-encoded binary X.509 certificate or PEM-encoded X.509 certificate. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">DataSize</td><td>The size of data buffer in bytes.</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">EFI_SUCCESS</td><td>The operation succeeded. </td></tr>
    <tr><td class="paramname">EFI_INVALID_PARAMETER</td><td>The parameter is invalid. </td></tr>
    <tr><td class="paramname">EFI_OUT_OF_RESOURCES</td><td>Required resources could not be allocated. </td></tr>
    <tr><td class="paramname">EFI_ABORTED</td><td>Invalid X.509 certificate. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a70fac3ffe9f1fbb1cd25e0289c27ccdf"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">EFI_STATUS EFIAPI TlsSetSessionId </td>
          <td>(</td>
          <td class="paramtype">IN VOID *&#160;</td>
          <td class="paramname"><em>Tls</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IN UINT8 *&#160;</td>
          <td class="paramname"><em>SessionId</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IN UINT16&#160;</td>
          <td class="paramname"><em>SessionIdLen</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Sets a TLS/SSL session ID to be used during TLS/SSL connect.</p>
<p>This function sets a session ID to be used when the TLS/SSL connection is to be established.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">Tls</td><td>Pointer to the TLS object. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">SessionId</td><td>Session ID data used for session resumption. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">SessionIdLen</td><td>Length of Session ID in bytes.</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">EFI_SUCCESS</td><td>Session ID was set successfully. </td></tr>
    <tr><td class="paramname">EFI_INVALID_PARAMETER</td><td>The parameter is invalid. </td></tr>
    <tr><td class="paramname">EFI_UNSUPPORTED</td><td>No available session for ID setting. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a85ea82a94ee9fea1eb99a4f58a7a04b8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">VOID EFIAPI TlsSetVerify </td>
          <td>(</td>
          <td class="paramtype">IN VOID *&#160;</td>
          <td class="paramname"><em>Tls</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IN UINT32&#160;</td>
          <td class="paramname"><em>VerifyMode</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Set peer certificate verification mode for the TLS connection.</p>
<p>This function sets the verification mode flags for the TLS connection.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">Tls</td><td>Pointer to the TLS object. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">VerifyMode</td><td>A set of logically or'ed verification mode flags. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a23bc6107cee56b42c0e479303950a077"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">EFI_STATUS EFIAPI TlsSetVerifyHost </td>
          <td>(</td>
          <td class="paramtype">IN VOID *&#160;</td>
          <td class="paramname"><em>Tls</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IN UINT32&#160;</td>
          <td class="paramname"><em>Flags</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IN CHAR8 *&#160;</td>
          <td class="paramname"><em>HostName</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Set the specified host name to be verified.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">Tls</td><td>Pointer to the TLS object. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">Flags</td><td>The setting flags during the validation. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">HostName</td><td>The specified host name to be verified.</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">EFI_SUCCESS</td><td>The HostName setting was set successfully. </td></tr>
    <tr><td class="paramname">EFI_INVALID_PARAMETER</td><td>The parameter is invalid. </td></tr>
    <tr><td class="paramname">EFI_ABORTED</td><td>Invalid HostName setting. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="aa9ccea993d60ac8d2c2c5fa8ceb1c0c2"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">EFI_STATUS EFIAPI TlsSetVersion </td>
          <td>(</td>
          <td class="paramtype">IN VOID *&#160;</td>
          <td class="paramname"><em>Tls</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IN UINT8&#160;</td>
          <td class="paramname"><em>MajorVer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IN UINT8&#160;</td>
          <td class="paramname"><em>MinorVer</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Set a new TLS/SSL method for a particular TLS object.</p>
<p>This function sets a new TLS/SSL method for a particular TLS object.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">Tls</td><td>Pointer to a TLS object. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">MajorVer</td><td>Major Version of TLS/SSL Protocol. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">MinorVer</td><td>Minor Version of TLS/SSL Protocol.</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">EFI_SUCCESS</td><td>The TLS/SSL method was set successfully. </td></tr>
    <tr><td class="paramname">EFI_INVALID_PARAMETER</td><td>The parameter is invalid. </td></tr>
    <tr><td class="paramname">EFI_UNSUPPORTED</td><td>Unsupported TLS/SSL method. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="ad9debfdd835519b01aadb903b2b7c5e9"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">INTN EFIAPI TlsWrite </td>
          <td>(</td>
          <td class="paramtype">IN VOID *&#160;</td>
          <td class="paramname"><em>Tls</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IN VOID *&#160;</td>
          <td class="paramname"><em>Buffer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IN UINTN&#160;</td>
          <td class="paramname"><em>BufferSize</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Attempts to write data to a TLS connection.</p>
<p>This function tries to write BufferSize bytes data from the Buffer into the specified TLS connection.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">Tls</td><td>Pointer to the TLS connection for data writing. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">Buffer</td><td>Pointer to the data buffer. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">BufferSize</td><td>The size of Buffer in bytes.</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">&gt;0</td><td>The write operation was successful, and return value is the number of bytes actually written to the TLS connection. </td></tr>
    <tr><td class="paramname">&lt;=0</td><td>The write operation was not successful. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_11dec8e5182d717c236bd44e9d0b396c.html">CryptoPkg</a></li><li class="navelem"><a class="el" href="dir_38f5e5f17a87d9f96b48468af1983957.html">Include</a></li><li class="navelem"><a class="el" href="dir_60b4316cb6c95682fa3ae9af44c008b1.html">Library</a></li><li class="navelem"><a class="el" href="_tls_lib_8h.html">TlsLib.h</a></li>
    <li class="footer">Generated on Sun Dec 5 2021 00:11:56 for CryptoPkg[all] by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.6 </li>
  </ul>
</div>
</body>
</html>
