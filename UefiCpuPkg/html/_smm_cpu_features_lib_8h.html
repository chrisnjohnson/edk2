<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<title>UefiCpuPkg[all]: UefiCpuPkg/Include/Library/SmmCpuFeaturesLib.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">UefiCpuPkg[all]
   &#160;<span id="projectnumber">0.90</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('_smm_cpu_features_lib_8h.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#enum-members">Enumerations</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">SmmCpuFeaturesLib.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="enum-members"></a>
Enumerations</h2></td></tr>
<tr class="memitem:a3c31fc7e98ac196624eeb415e021db82"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_smm_cpu_features_lib_8h.html#a3c31fc7e98ac196624eeb415e021db82">SMM_REG_NAME</a> { <a class="el" href="_smm_cpu_features_lib_8h.html#a3c31fc7e98ac196624eeb415e021db82a7d1311ee182357e154f91e748c2d21b8">SmmRegFeatureControl</a>, 
<a class="el" href="_smm_cpu_features_lib_8h.html#a3c31fc7e98ac196624eeb415e021db82a027f789c83de78e5a54e63d38237c10a">SmmRegSmmEnable</a>, 
<a class="el" href="_smm_cpu_features_lib_8h.html#a3c31fc7e98ac196624eeb415e021db82a63da28ed80e7fd7bff77ca1dc0679635">SmmRegSmmDelayed</a>, 
<a class="el" href="_smm_cpu_features_lib_8h.html#a3c31fc7e98ac196624eeb415e021db82ae23f59502c17798a5f868c40a3489ed1">SmmRegSmmBlocked</a>
 }</td></tr>
<tr class="separator:a3c31fc7e98ac196624eeb415e021db82"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a71b2dab06402a4b2f32a1d2aeab6cdb0"><td class="memItemLeft" align="right" valign="top">VOID EFIAPI&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_smm_cpu_features_lib_8h.html#a71b2dab06402a4b2f32a1d2aeab6cdb0">SmmCpuFeaturesInitializeProcessor</a> (IN UINTN CpuIndex, IN BOOLEAN IsMonarch, IN EFI_PROCESSOR_INFORMATION *ProcessorInfo, IN <a class="el" href="struct_c_p_u___h_o_t___p_l_u_g___d_a_t_a.html">CPU_HOT_PLUG_DATA</a> *CpuHotPlugData)</td></tr>
<tr class="separator:a71b2dab06402a4b2f32a1d2aeab6cdb0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1348505d02ebe425fa66295b01f34de1"><td class="memItemLeft" align="right" valign="top">UINT64 EFIAPI&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_smm_cpu_features_lib_8h.html#a1348505d02ebe425fa66295b01f34de1">SmmCpuFeaturesHookReturnFromSmm</a> (IN UINTN CpuIndex, IN SMRAM_SAVE_STATE_MAP *CpuState, IN UINT64 NewInstructionPointer32, IN UINT64 NewInstructionPointer)</td></tr>
<tr class="separator:a1348505d02ebe425fa66295b01f34de1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a49c5e182da4f7dfc3cbe5ceb71b668d1"><td class="memItemLeft" align="right" valign="top">VOID EFIAPI&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_smm_cpu_features_lib_8h.html#a49c5e182da4f7dfc3cbe5ceb71b668d1">SmmCpuFeaturesSmmRelocationComplete</a> (VOID)</td></tr>
<tr class="separator:a49c5e182da4f7dfc3cbe5ceb71b668d1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeee4714aaaa2c7fc970bc1e4df1e0230"><td class="memItemLeft" align="right" valign="top">UINTN EFIAPI&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_smm_cpu_features_lib_8h.html#aeee4714aaaa2c7fc970bc1e4df1e0230">SmmCpuFeaturesGetSmiHandlerSize</a> (VOID)</td></tr>
<tr class="separator:aeee4714aaaa2c7fc970bc1e4df1e0230"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abeda0806020fd732223236c1f5b1b1d5"><td class="memItemLeft" align="right" valign="top">VOID EFIAPI&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_smm_cpu_features_lib_8h.html#abeda0806020fd732223236c1f5b1b1d5">SmmCpuFeaturesInstallSmiHandler</a> (IN UINTN CpuIndex, IN UINT32 SmBase, IN VOID *SmiStack, IN UINTN StackSize, IN UINTN GdtBase, IN UINTN GdtSize, IN UINTN IdtBase, IN UINTN IdtSize, IN UINT32 Cr3)</td></tr>
<tr class="separator:abeda0806020fd732223236c1f5b1b1d5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abab425ad042566ff76a3b3eeebfb4927"><td class="memItemLeft" align="right" valign="top">BOOLEAN EFIAPI&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_smm_cpu_features_lib_8h.html#abab425ad042566ff76a3b3eeebfb4927">SmmCpuFeaturesNeedConfigureMtrrs</a> (VOID)</td></tr>
<tr class="separator:abab425ad042566ff76a3b3eeebfb4927"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae621921a0925115f4423727e788499e1"><td class="memItemLeft" align="right" valign="top">VOID EFIAPI&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_smm_cpu_features_lib_8h.html#ae621921a0925115f4423727e788499e1">SmmCpuFeaturesDisableSmrr</a> (VOID)</td></tr>
<tr class="separator:ae621921a0925115f4423727e788499e1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a82525fa1accc3e70b2eb42782be265cf"><td class="memItemLeft" align="right" valign="top">VOID EFIAPI&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_smm_cpu_features_lib_8h.html#a82525fa1accc3e70b2eb42782be265cf">SmmCpuFeaturesReenableSmrr</a> (VOID)</td></tr>
<tr class="separator:a82525fa1accc3e70b2eb42782be265cf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a770aef25909eb5b00c29902b07a03206"><td class="memItemLeft" align="right" valign="top">VOID EFIAPI&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_smm_cpu_features_lib_8h.html#a770aef25909eb5b00c29902b07a03206">SmmCpuFeaturesRendezvousEntry</a> (IN UINTN CpuIndex)</td></tr>
<tr class="separator:a770aef25909eb5b00c29902b07a03206"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeaf32d8795b1b9dcfa3bf815c78f36b0"><td class="memItemLeft" align="right" valign="top">VOID EFIAPI&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_smm_cpu_features_lib_8h.html#aeaf32d8795b1b9dcfa3bf815c78f36b0">SmmCpuFeaturesRendezvousExit</a> (IN UINTN CpuIndex)</td></tr>
<tr class="separator:aeaf32d8795b1b9dcfa3bf815c78f36b0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8b05a0934f372609143277fcd9d9a209"><td class="memItemLeft" align="right" valign="top">BOOLEAN EFIAPI&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_smm_cpu_features_lib_8h.html#a8b05a0934f372609143277fcd9d9a209">SmmCpuFeaturesIsSmmRegisterSupported</a> (IN UINTN CpuIndex, IN <a class="el" href="_smm_cpu_features_lib_8h.html#a3c31fc7e98ac196624eeb415e021db82">SMM_REG_NAME</a> RegName)</td></tr>
<tr class="separator:a8b05a0934f372609143277fcd9d9a209"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a001ea4d2d2a880f0323ca2578f85a0e5"><td class="memItemLeft" align="right" valign="top">UINT64 EFIAPI&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_smm_cpu_features_lib_8h.html#a001ea4d2d2a880f0323ca2578f85a0e5">SmmCpuFeaturesGetSmmRegister</a> (IN UINTN CpuIndex, IN <a class="el" href="_smm_cpu_features_lib_8h.html#a3c31fc7e98ac196624eeb415e021db82">SMM_REG_NAME</a> RegName)</td></tr>
<tr class="separator:a001ea4d2d2a880f0323ca2578f85a0e5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa8741c0808682144358e59f919be0b1a"><td class="memItemLeft" align="right" valign="top">VOID EFIAPI&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_smm_cpu_features_lib_8h.html#aa8741c0808682144358e59f919be0b1a">SmmCpuFeaturesSetSmmRegister</a> (IN UINTN CpuIndex, IN <a class="el" href="_smm_cpu_features_lib_8h.html#a3c31fc7e98ac196624eeb415e021db82">SMM_REG_NAME</a> RegName, IN UINT64 Value)</td></tr>
<tr class="separator:aa8741c0808682144358e59f919be0b1a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2a57490c47bee0ba69a5d1ed070fa3e5"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_smm_cpu_service_8h.html#aa912fa40d94e864cadb282680c18a4c1">EFI_STATUS</a> EFIAPI&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_smm_cpu_features_lib_8h.html#a2a57490c47bee0ba69a5d1ed070fa3e5">SmmCpuFeaturesReadSaveStateRegister</a> (IN UINTN CpuIndex, IN EFI_SMM_SAVE_STATE_REGISTER Register, IN UINTN Width, OUT VOID *<a class="el" href="_shadow_microcode_8h.html#a661f7f953e552d561f26e001f153ac27">Buffer</a>)</td></tr>
<tr class="separator:a2a57490c47bee0ba69a5d1ed070fa3e5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a172bad401daf7d2e7daab3e00bd6820a"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_smm_cpu_service_8h.html#aa912fa40d94e864cadb282680c18a4c1">EFI_STATUS</a> EFIAPI&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_smm_cpu_features_lib_8h.html#a172bad401daf7d2e7daab3e00bd6820a">SmmCpuFeaturesWriteSaveStateRegister</a> (IN UINTN CpuIndex, IN EFI_SMM_SAVE_STATE_REGISTER Register, IN UINTN Width, IN CONST VOID *<a class="el" href="_shadow_microcode_8h.html#a661f7f953e552d561f26e001f153ac27">Buffer</a>)</td></tr>
<tr class="separator:a172bad401daf7d2e7daab3e00bd6820a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a069f28f9a73c618c0537cde031902b4c"><td class="memItemLeft" align="right" valign="top">VOID EFIAPI&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_smm_cpu_features_lib_8h.html#a069f28f9a73c618c0537cde031902b4c">SmmCpuFeaturesCompleteSmmReadyToLock</a> (VOID)</td></tr>
<tr class="separator:a069f28f9a73c618c0537cde031902b4c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af341094d252fed16dcd893ab7a06493a"><td class="memItemLeft" align="right" valign="top">VOID *EFIAPI&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_smm_cpu_features_lib_8h.html#af341094d252fed16dcd893ab7a06493a">SmmCpuFeaturesAllocatePageTableMemory</a> (IN UINTN Pages)</td></tr>
<tr class="separator:af341094d252fed16dcd893ab7a06493a"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Library that provides CPU specific functions to support the PiSmmCpuDxeSmm module.</p>
<p>Copyright (c) 2015 - 2019, Intel Corporation. All rights reserved.<br/>
 SPDX-License-Identifier: BSD-2-Clause-Patent </p>
</div><h2 class="groupheader">Enumeration Type Documentation</h2>
<a class="anchor" id="a3c31fc7e98ac196624eeb415e021db82"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="_smm_cpu_features_lib_8h.html#a3c31fc7e98ac196624eeb415e021db82">SMM_REG_NAME</a></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Enumeration of SMM registers that are accessed using the library functions SmmCpuFeaturesIsSmmRegisterSupported (), SmmCpuFeaturesGetSmmRegister (), and SmmCpuFeaturesSetSmmRegister (). </p>
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><em><a class="anchor" id="a3c31fc7e98ac196624eeb415e021db82a7d1311ee182357e154f91e748c2d21b8"></a>SmmRegFeatureControl</em>&#160;</td><td class="fielddoc">
<p>Read-write register to provides access to MSR_SMM_FEATURE_CONTROL if the CPU supports this MSR. </p>
</td></tr>
<tr><td class="fieldname"><em><a class="anchor" id="a3c31fc7e98ac196624eeb415e021db82a027f789c83de78e5a54e63d38237c10a"></a>SmmRegSmmEnable</em>&#160;</td><td class="fielddoc">
<p>Read-only register that returns a non-zero value if the CPU is able to respond to SMIs. </p>
</td></tr>
<tr><td class="fieldname"><em><a class="anchor" id="a3c31fc7e98ac196624eeb415e021db82a63da28ed80e7fd7bff77ca1dc0679635"></a>SmmRegSmmDelayed</em>&#160;</td><td class="fielddoc">
<p>Read-only register that returns a non-zero value if the CPU is able to respond to SMIs, but is busy with other actions that are causing a delay in responding to an SMI. This register abstracts access to MSR_SMM_DELAYED if the CPU supports this MSR. </p>
</td></tr>
<tr><td class="fieldname"><em><a class="anchor" id="a3c31fc7e98ac196624eeb415e021db82ae23f59502c17798a5f868c40a3489ed1"></a>SmmRegSmmBlocked</em>&#160;</td><td class="fielddoc">
<p>Read-only register that returns a non-zero value if the CPU is able to respond to SMIs, but is busy with other actions that are blocking its ability to respond to an SMI. This register abstracts access to MSR_SMM_BLOCKED if the CPU supports this MSR. </p>
</td></tr>
</table>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="af341094d252fed16dcd893ab7a06493a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">VOID* EFIAPI SmmCpuFeaturesAllocatePageTableMemory </td>
          <td>(</td>
          <td class="paramtype">IN UINTN&#160;</td>
          <td class="paramname"><em>Pages</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This API provides a method for a CPU to allocate a specific region for storing page tables.</p>
<p>This API can be called more once to allocate memory for page tables.</p>
<p>Allocates the number of 4KB pages of type EfiRuntimeServicesData and returns a pointer to the allocated buffer. The buffer returned is aligned on a 4KB boundary. If Pages is 0, then NULL is returned. If there is not enough memory remaining to satisfy the request, then NULL is returned.</p>
<p>This function can also return NULL if there is no preference on where the page tables are allocated in SMRAM.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">Pages</td><td>The number of 4 KB pages to allocate.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A pointer to the allocated buffer for page tables. </dd></dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">NULL</td><td>Fail to allocate a specific region for storing page tables, Or there is no preference on where the page tables are allocated in SMRAM. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a069f28f9a73c618c0537cde031902b4c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">VOID EFIAPI SmmCpuFeaturesCompleteSmmReadyToLock </td>
          <td>(</td>
          <td class="paramtype">VOID&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This function is hook point called after the gEfiSmmReadyToLockProtocolGuid notification is completely processed. </p>

</div>
</div>
<a class="anchor" id="ae621921a0925115f4423727e788499e1"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">VOID EFIAPI SmmCpuFeaturesDisableSmrr </td>
          <td>(</td>
          <td class="paramtype">VOID&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Disable SMRR register if SMRR is supported and <a class="el" href="_smm_cpu_features_lib_8h.html#abab425ad042566ff76a3b3eeebfb4927">SmmCpuFeaturesNeedConfigureMtrrs()</a> returns TRUE. </p>

</div>
</div>
<a class="anchor" id="aeee4714aaaa2c7fc970bc1e4df1e0230"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">UINTN EFIAPI SmmCpuFeaturesGetSmiHandlerSize </td>
          <td>(</td>
          <td class="paramtype">VOID&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Return the size, in bytes, of a custom SMI Handler in bytes. If 0 is returned, then a custom SMI handler is not provided by this library, and the default SMI handler must be used.</p>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>Use the default SMI handler. </td></tr>
    <tr><td class="paramname">&gt;</td><td>0 Use the SMI handler installed by <a class="el" href="_smm_cpu_features_lib_8h.html#abeda0806020fd732223236c1f5b1b1d5">SmmCpuFeaturesInstallSmiHandler()</a> The caller is required to allocate enough SMRAM for each CPU to support the size of the custom SMI handler. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a001ea4d2d2a880f0323ca2578f85a0e5"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">UINT64 EFIAPI SmmCpuFeaturesGetSmmRegister </td>
          <td>(</td>
          <td class="paramtype">IN UINTN&#160;</td>
          <td class="paramname"><em>CpuIndex</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IN <a class="el" href="_smm_cpu_features_lib_8h.html#a3c31fc7e98ac196624eeb415e021db82">SMM_REG_NAME</a>&#160;</td>
          <td class="paramname"><em>RegName</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Returns the current value of the SMM register for the specified CPU. If the SMM register is not supported, then 0 is returned.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">CpuIndex</td><td>The index of the CPU to read the SMM register. The value must be between 0 and the NumberOfCpus field in the System Management System Table (SMST). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">RegName</td><td>Identifies the SMM register to read.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The value of the SMM register specified by RegName from the CPU specified by CpuIndex. </dd></dl>

</div>
</div>
<a class="anchor" id="a1348505d02ebe425fa66295b01f34de1"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">UINT64 EFIAPI SmmCpuFeaturesHookReturnFromSmm </td>
          <td>(</td>
          <td class="paramtype">IN UINTN&#160;</td>
          <td class="paramname"><em>CpuIndex</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IN SMRAM_SAVE_STATE_MAP *&#160;</td>
          <td class="paramname"><em>CpuState</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IN UINT64&#160;</td>
          <td class="paramname"><em>NewInstructionPointer32</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IN UINT64&#160;</td>
          <td class="paramname"><em>NewInstructionPointer</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This function updates the SMRAM save state on the currently executing CPU to resume execution at a specific address after an RSM instruction. This function must evaluate the SMRAM save state to determine the execution mode the RSM instruction resumes and update the resume execution address with either NewInstructionPointer32 or NewInstructionPoint. The auto HALT restart flag in the SMRAM save state must always be cleared. This function returns the value of the instruction pointer from the SMRAM save state that was replaced. If this function returns 0, then the SMRAM save state was not modified.</p>
<p>This function is called during the very first SMI on each CPU after <a class="el" href="_smm_cpu_features_lib_8h.html#a71b2dab06402a4b2f32a1d2aeab6cdb0">SmmCpuFeaturesInitializeProcessor()</a> to set a flag in normal execution mode to signal that the SMBASE of each CPU has been updated before the default SMBASE address is used for the first SMI to the next CPU.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">CpuIndex</td><td>The index of the CPU to hook. The value must be between 0 and the NumberOfCpus field in the System Management System Table (SMST). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">CpuState</td><td>Pointer to SMRAM Save State Map for the currently executing CPU. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">NewInstructionPointer32</td><td>Instruction pointer to use if resuming to 32-bit execution mode from 64-bit SMM. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">NewInstructionPointer</td><td>Instruction pointer to use if resuming to same execution mode as SMM.</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>This function did modify the SMRAM save state. </td></tr>
    <tr><td class="paramname">&gt;</td><td>0 The original instruction pointer value from the SMRAM save state before it was replaced. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a71b2dab06402a4b2f32a1d2aeab6cdb0"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">VOID EFIAPI SmmCpuFeaturesInitializeProcessor </td>
          <td>(</td>
          <td class="paramtype">IN UINTN&#160;</td>
          <td class="paramname"><em>CpuIndex</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IN BOOLEAN&#160;</td>
          <td class="paramname"><em>IsMonarch</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IN EFI_PROCESSOR_INFORMATION *&#160;</td>
          <td class="paramname"><em>ProcessorInfo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IN <a class="el" href="struct_c_p_u___h_o_t___p_l_u_g___d_a_t_a.html">CPU_HOT_PLUG_DATA</a> *&#160;</td>
          <td class="paramname"><em>CpuHotPlugData</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Called during the very first SMI into System Management Mode to initialize CPU features, including SMBASE, for the currently executing CPU. Since this is the first SMI, the SMRAM Save State Map is at the default address of SMM_DEFAULT_SMBASE + SMRAM_SAVE_STATE_MAP_OFFSET. The currently executing CPU is specified by CpuIndex and CpuIndex can be used to access information about the currently executing CPU in the ProcessorInfo array and the HotPlugCpuData data structure.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">CpuIndex</td><td>The index of the CPU to initialize. The value must be between 0 and the NumberOfCpus field in the System Management System Table (SMST). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">IsMonarch</td><td>TRUE if the CpuIndex is the index of the CPU that was elected as monarch during System Management Mode initialization. FALSE if the CpuIndex is not the index of the CPU that was elected as monarch during System Management Mode initialization. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ProcessorInfo</td><td>Pointer to an array of EFI_PROCESSOR_INFORMATION structures. ProcessorInfo[CpuIndex] contains the information for the currently executing CPU. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">CpuHotPlugData</td><td>Pointer to the <a class="el" href="struct_c_p_u___h_o_t___p_l_u_g___d_a_t_a.html">CPU_HOT_PLUG_DATA</a> structure that contains the ApidId and SmBase arrays. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="abeda0806020fd732223236c1f5b1b1d5"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">VOID EFIAPI SmmCpuFeaturesInstallSmiHandler </td>
          <td>(</td>
          <td class="paramtype">IN UINTN&#160;</td>
          <td class="paramname"><em>CpuIndex</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IN UINT32&#160;</td>
          <td class="paramname"><em>SmBase</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IN VOID *&#160;</td>
          <td class="paramname"><em>SmiStack</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IN UINTN&#160;</td>
          <td class="paramname"><em>StackSize</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IN UINTN&#160;</td>
          <td class="paramname"><em>GdtBase</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IN UINTN&#160;</td>
          <td class="paramname"><em>GdtSize</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IN UINTN&#160;</td>
          <td class="paramname"><em>IdtBase</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IN UINTN&#160;</td>
          <td class="paramname"><em>IdtSize</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IN UINT32&#160;</td>
          <td class="paramname"><em>Cr3</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Install a custom SMI handler for the CPU specified by CpuIndex. This function is only called if <a class="el" href="_smm_cpu_features_lib_8h.html#aeee4714aaaa2c7fc970bc1e4df1e0230">SmmCpuFeaturesGetSmiHandlerSize()</a> returns a size is greater than zero and is called by the CPU that was elected as monarch during System Management Mode initialization.</p>
<p>Append Shadow Stack after normal stack</p>
<p>|= SmiStack +-----------------------------------------------&mdash;+------------------------------------------------------------&mdash;+ | Known Good Stack | Guard Page | SMM Stack | Known Good Shadow Stack | Guard Page | SMM Shadow Stack | +-----------------------------------------------&mdash;+------------------------------------------------------------&mdash;+ | |PcdCpuSmmStackSize| |PcdCpuSmmShadowStackSize| |&lt;-----------------&mdash; StackSize --------------&mdash;&gt;|&lt;----------------------&mdash; ShadowStackSize ----------------&mdash;&gt;| | | |&lt;-----------------------------------------&mdash; Processor N ----------------------------------------------------&mdash;&gt;| | low address (bottom) high address (top) |</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">CpuIndex</td><td>The index of the CPU to install the custom SMI handler. The value must be between 0 and the NumberOfCpus field in the System Management System Table (SMST). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">SmBase</td><td>The SMBASE address for the CPU specified by CpuIndex. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">SmiStack</td><td>The bottom of stack to use when an SMI is processed by the the CPU specified by CpuIndex. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">StackSize</td><td>The size, in bytes, if the stack used when an SMI is processed by the CPU specified by CpuIndex. StackSize should be PcdCpuSmmStackSize, with 2 more pages if PcdCpuSmmStackGuard is true. If ShadowStack is enabled, the shadow stack is allocated after the normal Stack. The size is PcdCpuSmmShadowStackSize. with 2 more pages if PcdCpuSmmStackGuard is true. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">GdtBase</td><td>The base address of the GDT to use when an SMI is processed by the CPU specified by CpuIndex. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">GdtSize</td><td>The size, in bytes, of the GDT used when an SMI is processed by the CPU specified by CpuIndex. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">IdtBase</td><td>The base address of the IDT to use when an SMI is processed by the CPU specified by CpuIndex. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">IdtSize</td><td>The size, in bytes, of the IDT used when an SMI is processed by the CPU specified by CpuIndex. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">Cr3</td><td>The base address of the page tables to use when an SMI is processed by the CPU specified by CpuIndex. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a8b05a0934f372609143277fcd9d9a209"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">BOOLEAN EFIAPI SmmCpuFeaturesIsSmmRegisterSupported </td>
          <td>(</td>
          <td class="paramtype">IN UINTN&#160;</td>
          <td class="paramname"><em>CpuIndex</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IN <a class="el" href="_smm_cpu_features_lib_8h.html#a3c31fc7e98ac196624eeb415e021db82">SMM_REG_NAME</a>&#160;</td>
          <td class="paramname"><em>RegName</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Check to see if an SMM register is supported by a specified CPU.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">CpuIndex</td><td>The index of the CPU to check for SMM register support. The value must be between 0 and the NumberOfCpus field in the System Management System Table (SMST). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">RegName</td><td>Identifies the SMM register to check for support.</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">TRUE</td><td>The SMM register specified by RegName is supported by the CPU specified by CpuIndex. </td></tr>
    <tr><td class="paramname">FALSE</td><td>The SMM register specified by RegName is not supported by the CPU specified by CpuIndex. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="abab425ad042566ff76a3b3eeebfb4927"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">BOOLEAN EFIAPI SmmCpuFeaturesNeedConfigureMtrrs </td>
          <td>(</td>
          <td class="paramtype">VOID&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Determines if MTRR registers must be configured to set SMRAM cache-ability when executing in System Management Mode.</p>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">TRUE</td><td>MTRR registers must be configured to set SMRAM cache-ability. </td></tr>
    <tr><td class="paramname">FALSE</td><td>MTRR registers do not need to be configured to set SMRAM cache-ability. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a2a57490c47bee0ba69a5d1ed070fa3e5"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_smm_cpu_service_8h.html#aa912fa40d94e864cadb282680c18a4c1">EFI_STATUS</a> EFIAPI SmmCpuFeaturesReadSaveStateRegister </td>
          <td>(</td>
          <td class="paramtype">IN UINTN&#160;</td>
          <td class="paramname"><em>CpuIndex</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IN EFI_SMM_SAVE_STATE_REGISTER&#160;</td>
          <td class="paramname"><em>Register</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IN UINTN&#160;</td>
          <td class="paramname"><em>Width</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">OUT VOID *&#160;</td>
          <td class="paramname"><em>Buffer</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Read an SMM Save State register on the target processor. If this function returns EFI_UNSUPPORTED, then the caller is responsible for reading the SMM Save Sate register.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">CpuIndex</td><td>The index of the CPU to read the SMM Save State. The value must be between 0 and the NumberOfCpus field in the System Management System Table (SMST). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">Register</td><td>The SMM Save State register to read. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">Width</td><td>The number of bytes to read from the CPU save state. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">Buffer</td><td>Upon return, this holds the CPU register value read from the save state.</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">EFI_SUCCESS</td><td>The register was read from Save State. </td></tr>
    <tr><td class="paramname">EFI_INVALID_PARAMETER</td><td>Buffer is NULL. </td></tr>
    <tr><td class="paramname">EFI_UNSUPPORTED</td><td>This function does not support reading Register. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a82525fa1accc3e70b2eb42782be265cf"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">VOID EFIAPI SmmCpuFeaturesReenableSmrr </td>
          <td>(</td>
          <td class="paramtype">VOID&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Enable SMRR register if SMRR is supported and <a class="el" href="_smm_cpu_features_lib_8h.html#abab425ad042566ff76a3b3eeebfb4927">SmmCpuFeaturesNeedConfigureMtrrs()</a> returns TRUE. </p>

</div>
</div>
<a class="anchor" id="a770aef25909eb5b00c29902b07a03206"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">VOID EFIAPI SmmCpuFeaturesRendezvousEntry </td>
          <td>(</td>
          <td class="paramtype">IN UINTN&#160;</td>
          <td class="paramname"><em>CpuIndex</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Processor specific hook point each time a CPU enters System Management Mode.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">CpuIndex</td><td>The index of the CPU that has entered SMM. The value must be between 0 and the NumberOfCpus field in the System Management System Table (SMST). </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="aeaf32d8795b1b9dcfa3bf815c78f36b0"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">VOID EFIAPI SmmCpuFeaturesRendezvousExit </td>
          <td>(</td>
          <td class="paramtype">IN UINTN&#160;</td>
          <td class="paramname"><em>CpuIndex</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Processor specific hook point each time a CPU exits System Management Mode.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">CpuIndex</td><td>The index of the CPU that is exiting SMM. The value must be between 0 and the NumberOfCpus field in the System Management System Table (SMST). </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="aa8741c0808682144358e59f919be0b1a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">VOID EFIAPI SmmCpuFeaturesSetSmmRegister </td>
          <td>(</td>
          <td class="paramtype">IN UINTN&#160;</td>
          <td class="paramname"><em>CpuIndex</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IN <a class="el" href="_smm_cpu_features_lib_8h.html#a3c31fc7e98ac196624eeb415e021db82">SMM_REG_NAME</a>&#160;</td>
          <td class="paramname"><em>RegName</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IN UINT64&#160;</td>
          <td class="paramname"><em>Value</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Sets the value of an SMM register on a specified CPU. If the SMM register is not supported, then no action is performed.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">CpuIndex</td><td>The index of the CPU to write the SMM register. The value must be between 0 and the NumberOfCpus field in the System Management System Table (SMST). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">RegName</td><td>Identifies the SMM register to write. registers are read-only. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">Value</td><td>The value to write to the SMM register. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a49c5e182da4f7dfc3cbe5ceb71b668d1"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">VOID EFIAPI SmmCpuFeaturesSmmRelocationComplete </td>
          <td>(</td>
          <td class="paramtype">VOID&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Hook point in normal execution mode that allows the one CPU that was elected as monarch during System Management Mode initialization to perform additional initialization actions immediately after all of the CPUs have processed their first SMI and called <a class="el" href="_smm_cpu_features_lib_8h.html#a71b2dab06402a4b2f32a1d2aeab6cdb0">SmmCpuFeaturesInitializeProcessor()</a> relocating SMBASE into a buffer in SMRAM and called <a class="el" href="_smm_cpu_features_lib_8h.html#a1348505d02ebe425fa66295b01f34de1">SmmCpuFeaturesHookReturnFromSmm()</a>. </p>

</div>
</div>
<a class="anchor" id="a172bad401daf7d2e7daab3e00bd6820a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_smm_cpu_service_8h.html#aa912fa40d94e864cadb282680c18a4c1">EFI_STATUS</a> EFIAPI SmmCpuFeaturesWriteSaveStateRegister </td>
          <td>(</td>
          <td class="paramtype">IN UINTN&#160;</td>
          <td class="paramname"><em>CpuIndex</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IN EFI_SMM_SAVE_STATE_REGISTER&#160;</td>
          <td class="paramname"><em>Register</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IN UINTN&#160;</td>
          <td class="paramname"><em>Width</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IN CONST VOID *&#160;</td>
          <td class="paramname"><em>Buffer</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Writes an SMM Save State register on the target processor. If this function returns EFI_UNSUPPORTED, then the caller is responsible for writing the SMM Save Sate register.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">CpuIndex</td><td>The index of the CPU to write the SMM Save State. The value must be between 0 and the NumberOfCpus field in the System Management System Table (SMST). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">Register</td><td>The SMM Save State register to write. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">Width</td><td>The number of bytes to write to the CPU save state. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">Buffer</td><td>Upon entry, this holds the new CPU register value.</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">EFI_SUCCESS</td><td>The register was written to Save State. </td></tr>
    <tr><td class="paramname">EFI_INVALID_PARAMETER</td><td>Buffer is NULL. </td></tr>
    <tr><td class="paramname">EFI_UNSUPPORTED</td><td>This function does not support writing Register. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_bf5121888dfe870556fe9875eb4b3269.html">UefiCpuPkg</a></li><li class="navelem"><a class="el" href="dir_e701b125b1179e59bad921214df48aa3.html">Include</a></li><li class="navelem"><a class="el" href="dir_579c03b735c88d551dba5875fcdbb8bd.html">Library</a></li><li class="navelem"><a class="el" href="_smm_cpu_features_lib_8h.html">SmmCpuFeaturesLib.h</a></li>
    <li class="footer">Generated on Sun Dec 5 2021 03:41:28 for UefiCpuPkg[all] by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.6 </li>
  </ul>
</div>
</body>
</html>
