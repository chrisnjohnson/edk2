<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<title>EmbeddedPkg[all]: EmbeddedPkg/Include/Protocol/PeCoffLoader.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">EmbeddedPkg[all]
   &#160;<span id="projectnumber">0.1</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('_pe_coff_loader_8h.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">PeCoffLoader.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct___p_e___c_o_f_f___l_o_a_d_e_r___p_r_o_t_o_c_o_l.html">_PE_COFF_LOADER_PROTOCOL</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:ac24f17cbd3410400e2846ee35bde1474"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_pe_coff_loader_8h.html#ac24f17cbd3410400e2846ee35bde1474">PE_COFF_LOADER_PROTOCOL_GUID</a>&#160;&#160;&#160;{ 0xB323179B, 0x97FB, 0x477E, { 0xB0, 0xFE, 0xD8, 0x85, 0x91, 0xFA, 0x11, 0xAB } }</td></tr>
<tr class="separator:ac24f17cbd3410400e2846ee35bde1474"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:a2f2360df2ee1e27e12cfaace7ce270f0"><td class="memItemLeft" align="right" valign="top">typedef struct <br class="typebreak"/>
<a class="el" href="struct___p_e___c_o_f_f___l_o_a_d_e_r___p_r_o_t_o_c_o_l.html">_PE_COFF_LOADER_PROTOCOL</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_pe_coff_loader_8h.html#a2f2360df2ee1e27e12cfaace7ce270f0">PE_COFF_LOADER_PROTOCOL</a></td></tr>
<tr class="separator:a2f2360df2ee1e27e12cfaace7ce270f0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a833d32cd165bf3a731b2553f85a9dcb6"><td class="memItemLeft" align="right" valign="top">typedef IN UINTN&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_pe_coff_loader_8h.html#a833d32cd165bf3a731b2553f85a9dcb6">FileOffset</a></td></tr>
<tr class="separator:a833d32cd165bf3a731b2553f85a9dcb6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8a0e0b3136e00be01c88a9d62cad66da"><td class="memItemLeft" align="right" valign="top">typedef IN UINTN IN OUT UINTN *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_pe_coff_loader_8h.html#a8a0e0b3136e00be01c88a9d62cad66da">ReadSize</a></td></tr>
<tr class="separator:a8a0e0b3136e00be01c88a9d62cad66da"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adaa7a4173b9cce8a2305591c7f3ff41e"><td class="memItemLeft" align="right" valign="top">typedef IN UINTN IN OUT UINTN <br class="typebreak"/>
OUT <a class="el" href="_hardware_interrupt_8h.html#aae358f00374574528863ebc44b6be44a">VOID</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_pe_coff_loader_8h.html#adaa7a4173b9cce8a2305591c7f3ff41e">Buffer</a></td></tr>
<tr class="separator:adaa7a4173b9cce8a2305591c7f3ff41e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a17a0af4eeb80b48d2a6a28369a774298"><td class="memItemLeft" align="right" valign="top">typedef IN PHYSICAL_ADDRESS&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_pe_coff_loader_8h.html#a17a0af4eeb80b48d2a6a28369a774298">VirtImageBase</a></td></tr>
<tr class="separator:a17a0af4eeb80b48d2a6a28369a774298"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaca3e976e49d5fc2478956b294eca6aa"><td class="memItemLeft" align="right" valign="top">typedef IN PHYSICAL_ADDRESS IN <br class="typebreak"/>
UINTN&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_pe_coff_loader_8h.html#aaca3e976e49d5fc2478956b294eca6aa">ImageSize</a></td></tr>
<tr class="separator:aaca3e976e49d5fc2478956b294eca6aa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad8b3eb449e6253a7a8928300209e6598"><td class="memItemLeft" align="right" valign="top">typedef IN PHYSICAL_ADDRESS IN <br class="typebreak"/>
UINTN IN <a class="el" href="_hardware_interrupt_8h.html#aae358f00374574528863ebc44b6be44a">VOID</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_pe_coff_loader_8h.html#ad8b3eb449e6253a7a8928300209e6598">RelocationData</a></td></tr>
<tr class="separator:ad8b3eb449e6253a7a8928300209e6598"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ad47ec7f9d6dc2fa8266163d5f74496af"><td class="memItemLeft" align="right" valign="top">typedef&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_pe_coff_loader_8h.html#ad47ec7f9d6dc2fa8266163d5f74496af">RETURN_STATUS</a> (EFIAPI *PE_COFF_LOADER_GET_IMAGE_INFO)(IN OUT PE_COFF_LOADER_IMAGE_CONTEXT *ImageContext)</td></tr>
<tr class="separator:ad47ec7f9d6dc2fa8266163d5f74496af"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afceaca3d2c004c491d99dd6a6ede2e1a"><td class="memItemLeft" align="right" valign="top">typedef&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_pe_coff_loader_8h.html#afceaca3d2c004c491d99dd6a6ede2e1a">VOID</a> (EFIAPI *PE_COFF_LOADER_RELOCATE_IMAGE_FOR_RUNTIME)(IN PHYSICAL_ADDRESS ImageBase</td></tr>
<tr class="separator:afceaca3d2c004c491d99dd6a6ede2e1a"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:afc19098eabb0b44cbca929575067375c"><td class="memItemLeft" align="right" valign="top">EFI_GUID&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_pe_coff_loader_8h.html#afc19098eabb0b44cbca929575067375c">gPeCoffLoaderProtocolGuid</a></td></tr>
<tr class="separator:afc19098eabb0b44cbca929575067375c"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Copyright (c) 2006 - 2008, Intel Corporation. All rights reserved.<br/>
 Portions copyright (c) 2010, Apple Inc. All rights reserved.<br/>
 SPDX-License-Identifier: BSD-2-Clause-Patent </p>
</div><h2 class="groupheader">Macro Definition Documentation</h2>
<a class="anchor" id="ac24f17cbd3410400e2846ee35bde1474"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define PE_COFF_LOADER_PROTOCOL_GUID&#160;&#160;&#160;{ 0xB323179B, 0x97FB, 0x477E, { 0xB0, 0xFE, 0xD8, 0x85, 0x91, 0xFA, 0x11, 0xAB } }</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<h2 class="groupheader">Typedef Documentation</h2>
<a class="anchor" id="adaa7a4173b9cce8a2305591c7f3ff41e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef IN UINTN IN OUT UINTN OUT <a class="el" href="_hardware_interrupt_8h.html#aae358f00374574528863ebc44b6be44a">VOID</a>* <a class="el" href="_mmc_host_8h.html#a61723d9f648ae980f6ebde61312cb293">Buffer</a></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a833d32cd165bf3a731b2553f85a9dcb6"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef IN UINTN <a class="el" href="_pe_coff_loader_8h.html#a833d32cd165bf3a731b2553f85a9dcb6">FileOffset</a></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="aaca3e976e49d5fc2478956b294eca6aa"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef IN PHYSICAL_ADDRESS IN UINTN <a class="el" href="_pe_coff_loader_8h.html#aaca3e976e49d5fc2478956b294eca6aa">ImageSize</a></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a2f2360df2ee1e27e12cfaace7ce270f0"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="struct___p_e___c_o_f_f___l_o_a_d_e_r___p_r_o_t_o_c_o_l.html">_PE_COFF_LOADER_PROTOCOL</a> <a class="el" href="_pe_coff_loader_8h.html#a2f2360df2ee1e27e12cfaace7ce270f0">PE_COFF_LOADER_PROTOCOL</a></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a8a0e0b3136e00be01c88a9d62cad66da"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef IN UINTN IN OUT UINTN* <a class="el" href="_pe_coff_loader_8h.html#a8a0e0b3136e00be01c88a9d62cad66da">ReadSize</a></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="ad8b3eb449e6253a7a8928300209e6598"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef IN PHYSICAL_ADDRESS IN UINTN IN <a class="el" href="_hardware_interrupt_8h.html#aae358f00374574528863ebc44b6be44a">VOID</a>* <a class="el" href="_pe_coff_loader_8h.html#ad8b3eb449e6253a7a8928300209e6598">RelocationData</a></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a17a0af4eeb80b48d2a6a28369a774298"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef IN PHYSICAL_ADDRESS <a class="el" href="_pe_coff_loader_8h.html#a17a0af4eeb80b48d2a6a28369a774298">VirtImageBase</a></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="ad47ec7f9d6dc2fa8266163d5f74496af"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef RETURN_STATUS </td>
          <td>(</td>
          <td class="paramtype">EFIAPI *&#160;</td>
          <td class="paramname"><em>PE_COFF_LOADER_GET_IMAGE_INFO</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Retrieves information about a PE/COFF image.</p>
<p>Computes the PeCoffHeaderOffset, IsTeImage, ImageType, ImageAddress, ImageSize, DestinationAddress, RelocationsStripped, SectionAlignment, SizeOfHeaders, and DebugDirectoryEntryRva fields of the ImageContext structure. If ImageContext is NULL, then return RETURN_INVALID_PARAMETER. If the PE/COFF image accessed through the ImageRead service in the ImageContext structure is not a supported PE/COFF image type, then return RETURN_UNSUPPORTED. If any errors occur while computing the fields of ImageContext, then the error status is returned in the ImageError field of ImageContext. If the image is a TE image, then SectionAlignment is set to 0. The ImageRead and Handle fields of ImageContext structure must be valid prior to invoking this service.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ImageContext</td><td>Pointer to the image context structure that describes the PE/COFF image that needs to be examined by this function.</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">RETURN_SUCCESS</td><td>The information on the PE/COFF image was collected. </td></tr>
    <tr><td class="paramname">RETURN_INVALID_PARAMETER</td><td>ImageContext is NULL. </td></tr>
    <tr><td class="paramname">RETURN_UNSUPPORTED</td><td>The PE/COFF image is not supported.</td></tr>
  </table>
  </dd>
</dl>
<p>Applies relocation fixups to a PE/COFF image that was loaded with PeCoffLoaderLoadImage().</p>
<p>If the DestinationAddress field of ImageContext is 0, then use the ImageAddress field of ImageContext as the relocation base address. Otherwise, use the DestinationAddress field of ImageContext as the relocation base address. The caller must allocate the relocation fixup log buffer and fill in the FixupData field of ImageContext prior to calling this function.</p>
<p>The ImageRead, Handle, PeCoffHeaderOffset, IsTeImage, Machine, ImageType, ImageAddress, ImageSize, DestinationAddress, RelocationsStripped, SectionAlignment, SizeOfHeaders, DebugDirectoryEntryRva, EntryPoint, FixupDataSize, CodeView, PdbPointer, and FixupData of the ImageContext structure must be valid prior to invoking this service.</p>
<p>If ImageContext is NULL, then ASSERT().</p>
<p>Note that if the platform does not maintain coherency between the instruction cache(s) and the data cache(s) in hardware, then the caller is responsible for performing cache maintenance operations prior to transferring control to a PE/COFF image that is loaded using this library.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ImageContext</td><td>Pointer to the image context structure that describes the PE/COFF image that is being relocated.</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">RETURN_SUCCESS</td><td>The PE/COFF image was relocated. Extended status information is in the ImageError field of ImageContext. </td></tr>
    <tr><td class="paramname">RETURN_LOAD_ERROR</td><td>The image in not a valid PE/COFF image. Extended status information is in the ImageError field of ImageContext. </td></tr>
    <tr><td class="paramname">RETURN_UNSUPPORTED</td><td>A relocation record type is not supported. Extended status information is in the ImageError field of ImageContext.</td></tr>
  </table>
  </dd>
</dl>
<p>Loads a PE/COFF image into memory.</p>
<p>Loads the PE/COFF image accessed through the ImageRead service of ImageContext into the buffer specified by the ImageAddress and ImageSize fields of ImageContext. The caller must allocate the load buffer and fill in the ImageAddress and ImageSize fields prior to calling this function. The EntryPoint, FixupDataSize, CodeView, PdbPointer and HiiResourceData fields of ImageContext are computed. The ImageRead, Handle, PeCoffHeaderOffset, IsTeImage, Machine, ImageType, ImageAddress, ImageSize, DestinationAddress, RelocationsStripped, SectionAlignment, SizeOfHeaders, and DebugDirectoryEntryRva fields of the ImageContext structure must be valid prior to invoking this service.</p>
<p>If ImageContext is NULL, then ASSERT().</p>
<p>Note that if the platform does not maintain coherency between the instruction cache(s) and the data cache(s) in hardware, then the caller is responsible for performing cache maintenance operations prior to transferring control to a PE/COFF image that is loaded using this library.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ImageContext</td><td>Pointer to the image context structure that describes the PE/COFF image that is being loaded.</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">RETURN_SUCCESS</td><td>The PE/COFF image was loaded into the buffer specified by the ImageAddress and ImageSize fields of ImageContext. Extended status information is in the ImageError field of ImageContext. </td></tr>
    <tr><td class="paramname">RETURN_BUFFER_TOO_SMALL</td><td>The caller did not provide a large enough buffer. Extended status information is in the ImageError field of ImageContext. </td></tr>
    <tr><td class="paramname">RETURN_LOAD_ERROR</td><td>The PE/COFF image is an EFI Runtime image with no relocations. Extended status information is in the ImageError field of ImageContext. </td></tr>
    <tr><td class="paramname">RETURN_INVALID_PARAMETER</td><td>The image address is invalid. Extended status information is in the ImageError field of ImageContext.</td></tr>
  </table>
  </dd>
</dl>
<p>Reads contents of a PE/COFF image from a buffer in system memory.</p>
<p>This is the default implementation of a PE_COFF_LOADER_READ_FILE function that assumes FileHandle pointer to the beginning of a PE/COFF image. This function reads contents of the PE/COFF image that starts at the system memory address specified by FileHandle. The read operation copies ReadSize bytes from the PE/COFF image starting at byte offset FileOffset into the buffer specified by Buffer. The size of the buffer actually read is returned in ReadSize.</p>
<p>If FileHandle is NULL, then ASSERT(). If ReadSize is NULL, then ASSERT(). If Buffer is NULL, then ASSERT().</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">FileHandle</td><td>Pointer to base of the input stream </td></tr>
    <tr><td class="paramname">FileOffset</td><td>Offset into the PE/COFF image to begin the read operation. </td></tr>
    <tr><td class="paramname">ReadSize</td><td>On input, the size in bytes of the requested read operation. On output, the number of bytes actually read. </td></tr>
    <tr><td class="paramname">Buffer</td><td>Output buffer that contains the data read from the PE/COFF image.</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">RETURN_SUCCESS</td><td>Data is read from FileOffset from the Handle into the buffer.</td></tr>
  </table>
  </dd>
</dl>
<p>Unloads a loaded PE/COFF image from memory and releases its taken resource. Releases any environment specific resources that were allocated when the image specified by ImageContext was loaded using PeCoffLoaderLoadImage().</p>
<p>For NT32 emulator, the PE/COFF image loaded by system needs to release. For real platform, the PE/COFF image loaded by Core doesn't needs to be unloaded, this function can simply return RETURN_SUCCESS.</p>
<p>If ImageContext is NULL, then ASSERT().</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ImageContext</td><td>Pointer to the image context structure that describes the PE/COFF image to be unloaded.</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">RETURN_SUCCESS</td><td>The PE/COFF image was unloaded successfully. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="afceaca3d2c004c491d99dd6a6ede2e1a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef VOID </td>
          <td>(</td>
          <td class="paramtype">EFIAPI *&#160;</td>
          <td class="paramname"><em>PE_COFF_LOADER_RELOCATE_IMAGE_FOR_RUNTIME</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Reapply fixups on a fixed up PE32/PE32+ image to allow virtual calling at EFI runtime.</p>
<p>This function reapplies relocation fixups to the PE/COFF image specified by ImageBase and ImageSize so the image will execute correctly when the PE/COFF image is mapped to the address specified by VirtualImageBase. RelocationData must be identical to the FixupData buffer from the PE_COFF_LOADER_IMAGE_CONTEXT structure after this PE/COFF image was relocated with PeCoffLoaderRelocateImage().</p>
<p>Note that if the platform does not maintain coherency between the instruction cache(s) and the data cache(s) in hardware, then the caller is responsible for performing cache maintenance operations prior to transferring control to a PE/COFF image that is loaded using this library.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ImageBase</td><td>Base address of a PE/COFF image that has been loaded and relocated into system memory. </td></tr>
    <tr><td class="paramname">VirtImageBase</td><td>The request virtual address that the PE/COFF image is to be fixed up for. </td></tr>
    <tr><td class="paramname">ImageSize</td><td>The size, in bytes, of the PE/COFF image. </td></tr>
    <tr><td class="paramname">RelocationData</td><td>A pointer to the relocation data that was collected when the PE/COFF image was relocated using PeCoffLoaderRelocateImage(). </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a class="anchor" id="afc19098eabb0b44cbca929575067375c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">EFI_GUID gPeCoffLoaderProtocolGuid</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_59cf1afa603fca01f195fa40dc3faab7.html">EmbeddedPkg</a></li><li class="navelem"><a class="el" href="dir_291751e4e91a6e05f516b9f5db466867.html">Include</a></li><li class="navelem"><a class="el" href="dir_b23943dcc71c848b1fb1a32344653736.html">Protocol</a></li><li class="navelem"><a class="el" href="_pe_coff_loader_8h.html">PeCoffLoader.h</a></li>
    <li class="footer">Generated on Sun Dec 5 2021 00:11:57 for EmbeddedPkg[all] by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.6 </li>
  </ul>
</div>
</body>
</html>
